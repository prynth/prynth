"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = scserver;

/**
 * Send OSC to scsynth
 *
 * Command may have one of these three forms:
 *
 * msg: Array
 *
 * bundle: {
 *   time: null|Number|Array|Date
 *   packets: Array
 * }
 *
 * callAndResponse: {call: response: }
 */
function scserver(commands) {
  var promises = [];
  commands.forEach(function (commandContext) {
    var command = commandContext.command;
    var context = commandContext.context;

    if (command.scsynth) {
      if (command.scsynth.msg) {
        var m = command.scsynth.msg(context);
        // context.scsynth.send.msg(m);
        context.scsynth.send.bundle(0.03, [m]);
      }
      if (command.scsynth.bundle) {
        var b = command.scsynth.bundle(context);
        context.scsynth.send.bundle(b.time, b.packets);
      }
      if (command.scsynth.callAndResponse) {
        var c = command.scsynth.callAndResponse(context);
        promises.push(context.scsynth.callAndResponse(c));
      }
    }
  });
  return Promise.all(promises);
};
//# sourceMappingURL=scsynth.js.map
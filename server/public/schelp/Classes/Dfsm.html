<html><head><title>Dfsm</title>
<link rel='stylesheet' href='./../scdoc.css' type='text/css' />
<link rel='stylesheet' href='./../frontend.css' type='text/css' />
<link rel='stylesheet' href='./../custom.css' type='text/css' />
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<script src='./../scdoc.js' type='text/javascript'></script>
<script src='./../docmap.js' type='text/javascript'></script>
<script src='./../prettify.js' type='text/javascript'></script>
<script src='./../lang-sc.js' type='text/javascript'></script>
<script type='text/javascript'>var helpRoot='./..';</script>
</head>
<ul id='menubar'></ul>
<body onload='fixTOC();prettyPrint()'>
<div class='contents'>
<div class='header'>
<div id='label'>SuperCollider CLASSES (extension)</div>
<div id='categories'><a href='./../Browse.html#UGens>Demand'>UGens>Demand</a></div>
<h1>Dfsm</h1>
<div id='summary'>demand rate finite state machine</div>
</div>
<div class='subheader'>
<div id='filename'>Source: /usr/local/share/SuperCollider/Extensions/SC3plugins/TagSystemUGens/<a href='file:///usr/local/share/SuperCollider/Extensions/SC3plugins/TagSystemUGens/SymbolicMachines.sc'>SymbolicMachines.sc</a></div><div id='superclasses'>Inherits from: <a href="../Classes/DUGen.html">DUGen</a> : <a href="../Classes/UGen.html">UGen</a> : <a href="../Classes/AbstractFunction.html">AbstractFunction</a> : <a href="../Classes/Object.html">Object</a></div>
<div id='related'>See also: <a href="./../Classes/Pfsm.html">Pfsm</a></div>
</div>
<div id='toc'>
<ul class='toc'><li class='toc1'><a href='#description'>Description</a></li>
<ul class='toc'></ul><li class='toc1'><a href='#classmethods'>Class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*new'>new</a> </li>
<li class='toc2'><a href='#Inherited class methods'>Inherited class methods</a></li>
<li class='toc2'><a href='#Undocumented class methods'>Undocumented class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*convertRules'>convertRules</a> </li>
</ul></ul><li class='toc1'><a href='#instancemethods'>Instance methods</a></li>
<ul class='toc'><li class='toc2'><a href='#Inherited instance methods'>Inherited instance methods</a></li>
</ul><li class='toc1'><a href='#examples'>Examples</a></li>
<ul class='toc'></ul></ul></div><h2><a class='anchor' name='description'>Description</a></h2>

<p>Similar to <a href="./../Classes/Pfsm.html">Pfsm</a>, Dfsm implements a markov chain. Each state has a number of next states out of which one is randomly chosen.<h2><a class='anchor' name='classmethods'>Class Methods</a></h2>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*new' href='./../Overviews/Methods.html#new'>new</a> (<span class='argstr'>rules</span>, <span class='argstr'>n: 1</span>, <span class='argstr'>rgen</span>)</h3>
<div class='method'>
<p><h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>rules<td class='argumentdesc'>
<p>array in the format:<pre class='code prettyprint lang-sc'>[
    [ entry states ],
    item, [ next states ],
    item, [ next states ],
    ...
    end item
 ]</pre>

<p>Each <strong>item</strong> can be a number, or a ugen, typically demand rate. If no <strong>end item</strong> is given, <strong>0.0</strong> is used as default.<tr><td class='argumentname'>n<td class='argumentdesc'>
<p>number of items from each state to embed. If <strong>inf</strong>, they are embedded completely.<tr><td class='argumentname'>rgen<td class='argumentdesc'>
<p>demand rate random number generator that should ouput values between 0.0 and 1.0. If a deterministic ugen is used, the choice of next states of the finite state machine can be controlled (i.e. 0 will allways choose the first, 1 always the last, else in between).</table></div><h3><a class='anchor' name='Inherited class methods'>Inherited class methods</a></h3>
<div id='inheritedclassmets'></div><h3><a class='anchor' name='Undocumented class methods'>Undocumented class methods</a></h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*convertRules' href='./../Overviews/Methods.html#convertRules'>convertRules</a> (<span class='argstr'>rules</span>)</h3>
<h2><a class='anchor' name='instancemethods'>Instance Methods</a></h2>
<h3><a class='anchor' name='Inherited instance methods'>Inherited instance methods</a></h3>
<div id='inheritedinstmets'></div><h2><a class='anchor' name='examples'>Examples</a></h2>
<pre class='code prettyprint lang-sc'>s.boot;

// random jumps
(
{
    var a, b, trig = Impulse.kr(MouseX.kr(4, 100, 1));
    a = Dfsm([[1], 1.5, [0, 1], 2.5, [0, 1]]);
    b = Demand.kr(trig, 0, a).poll(trig);
    SinOsc.ar(b * 200 + 300) * 0.1
}.play
);

// 2.5 may come after 1.5, but not the other way round.
(
{
    var a, b, trig = Impulse.kr(MouseX.kr(4, 100, 1));
    a = Dfsm([[0], 1.5, [0, 0, 1], 2.5, [1, 2], 0.5, [0]]);
    b = Demand.kr(trig, 0, a).poll(trig);
    SinOsc.ar(b * 200 + 300) * 0.1
}.play
);



// embed demand ugens, embed 2 of each, end with series of 4, 5, 3.
(
{
    var a, n = 2, trig = Impulse.kr(MouseX.kr(4, 100, 1));
    a = Dfsm([
        [0], // entry states
        Dseq([-2, -3], inf), [1],
        Dseq([1, 2, 1.5], inf), [0, 0, 0, 1, 2],
        Dseq([4, 5, 3], inf) // exit state
    ], n);
    b = Demand.kr(trig, 0, a).poll(trig);
    SinOsc.ar(b * 200 + 700) * 0.1
}.play
);


// direct audification
(
{
    var a, b, pseudorandomness;
    pseudorandomness = Dswitch1((0..1000).scramble / 1000, Dwhite(0, 1, inf)
        * MouseY.kr(1, 1000, 1));
    a = {
        var next = { { #[0, 1, 2, 3].choose } ! rrand(2, 5) };
        var n = 2;
        var d = Dfsm([
            next.value,
            Dseq([0, 0, 1], inf), next.value,
            Dseq([-1, 0].clipExtend(10.rand + 2), inf), next.value,
            Dseq([1, 0, -1, 0].clipExtend(10.rand + 4), inf), next.value,
            Dwhite(0, 1, inf), next.value,
            0
        ],
        MouseX.kr(1, 1115, 1),
        pseudorandomness
        );
        Pan2.ar(Duty.ar(SampleDur.ir, 0, d), LFNoise1.kr(1))
    } ! 5;
    a.sum * 0.1;
}.play
);</pre>
<pre class='code prettyprint lang-sc'>///////////////////////////////////////////
// tests

// reset test.
(
{
    var a, trig = MouseButton.kr &gt; 0.5;
    a = Dfsm([[0], Dseq([-2, -3], inf), [1, 7], Dseq([0.1, 0.2], inf), [0, 1], Dseq([900], inf)]);
    Demand.kr(trig, 0, a); // should end after final state.
    Silent.ar;
}.play
);


// reset test.
(
{
    var a, trig = ;
    a = Dfsm([[0], Dseq([-2, -3], inf), [1, 7], Dseq([0.1, 0.2], inf), [0, 1], Dseq([900], inf)]);
    Demand.kr(trig, MouseButton.kr &gt; 0.5, Dseq([a], inf));
    Silent.ar;
}.play
);

// embedding test
(
a = { |t_reset|
    var trig = MouseButton.kr &gt; 0.5;
    a = Dfsm([[0], Dseq([-2, -3, -4], inf), [7], Dseq([0.1, 0.2], 1), [0, 1], Dseq([900, 90], inf)],
        2);
    Demand.kr(trig, t_reset, a);
    Silent.ar;
}.play
);

a.set(\t_reset, 1);</pre>

<p><div class='doclink'>source: <a href='file:///usr/local/share/SuperCollider/Extensions/SC3plugins/TagSystemUGens/HelpSource/Classes/Dfsm.schelp'>/usr/local/share/SuperCollider/Extensions/SC3plugins/TagSystemUGens/HelpSource/Classes/Dfsm.schelp</a><br>link::Classes/Dfsm::<br>sc version: 3.8dev</div></div></body></html>
<!doctype html><html lang='en'><head><title>IdentityDictionary | SuperCollider 3.9.3 Help</title>
<link rel='stylesheet' href='./../scdoc.css' type='text/css' />
<link rel='stylesheet' href='./../frontend.css' type='text/css' />
<link rel='stylesheet' href='./../custom.css' type='text/css' />
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<script>
var helpRoot = './..';
var scdoc_title = 'IdentityDictionary';
var scdoc_sc_version = '3.9.3';
</script>
<script src='./../scdoc.js' type='text/javascript'></script>
<script src='./../docmap.js' type='text/javascript'></script>
<script src='./../prettify.js' type='text/javascript'></script>
<script src='./../lang-sc.js' type='text/javascript'></script>
</head>
<body onload='fixTOC();prettyPrint()'>
<div id='toc'>
<div id='toctitle'>IdentityDictionary:</div>
<span class='toc_search'>Filter: <input id='toc_search'></span><ul class='toc'><li class='toc1'><a href='#description'>Description</a></li>
<ul class='toc'><li class='toc2'><a href='#'parent'%20and%20'proto'%20variables'>'parent' and 'proto' variables</a></li>
<ul class='toc'></ul></ul><li class='toc1'><a href='#classmethods'>Class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*new'>new</a> </li>
<li class='toc2'><a href='#Inherited%20class%20methods'>Inherited class methods</a></li>
</ul><li class='toc1'><a href='#instancemethods'>Instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-know'>know</a> </li>
<li class='toc3'><a href='#-putGet'>putGet</a> </li>
<li class='toc3'><a href='#-includesKey'>includesKey</a> </li>
<li class='toc3'><a href='#-findKeyForValue'>findKeyForValue</a> </li>
<li class='toc3'><a href='#-proto'>proto</a>  <a href='#-parent'>parent</a> </li>
<li class='toc3'><a href='#-insertParent'>insertParent</a> </li>
<li class='toc2'><a href='#Timing%20support%20(Quant)'>Timing support (Quant)</a></li>
<ul class='toc'><li class='toc3'><a href='#-nextTimeOnGrid'>nextTimeOnGrid</a>  <a href='#-asQuant'>asQuant</a>  <a href='#-timingOffset'>timingOffset</a> </li>
</ul><li class='toc2'><a href='#Garbage%20collection'>Garbage collection</a></li>
<ul class='toc'><li class='toc3'><a href='#-freezeAsParent'>freezeAsParent</a> </li>
</ul><li class='toc2'><a href='#Inherited%20instance%20methods'>Inherited instance methods</a></li>
<li class='toc2'><a href='#Undocumented%20instance%20methods'>Undocumented instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-=='>==</a> </li>
<li class='toc3'><a href='#-at'>at</a> </li>
<li class='toc3'><a href='#-collect'>collect</a> </li>
<li class='toc3'><a href='#-doesNotUnderstand'>doesNotUnderstand</a> </li>
<li class='toc3'><a href='#-hash'>hash</a> </li>
<li class='toc3'><a href='#-put'>put</a> </li>
<li class='toc3'><a href='#-reject'>reject</a> </li>
<li class='toc3'><a href='#-scanFor'>scanFor</a> </li>
<li class='toc3'><a href='#-select'>select</a> </li>
<li class='toc3'><a href='#-storeItemsOn'>storeItemsOn</a> </li>
</ul></ul></ul></div><div class='contents'>
<div id='menubar'></div>
<div class='header'>
<div id='label'>
<span id='folder'>Classes</span>
 | <span id='categories'><a href='./../Browse.html#Collections'>Collections</a>&#8201;&gt;&#8201;<a href='./../Browse.html#Collections>Unordered'>Unordered</a></span>
</div><h1>IdentityDictionary<span id='superclasses'> : <a href="../Classes/Dictionary.html">Dictionary</a> : <a href="../Classes/Set.html">Set</a> : <a href="../Classes/Collection.html">Collection</a> : <a href="../Classes/Object.html">Object</a></span>
</h1>
<div id='summary'>associative collection mapping keys to values</div>
</div>
<div class='subheader'>
<div id='filename'>Source: <a href='file:///private/var/folders/qf/zrk81q7s6ygdbbgwm1_h5gc80000gn/T/AppTranslocation/8BAA739F-B195-446C-A6B4-C103296EBF70/d/SuperCollider.app/Contents/Resources/SCClassLibrary/Common/Collections/Dictionary.sc' title='/private/var/folders/qf/zrk81q7s6ygdbbgwm1_h5gc80000gn/T/AppTranslocation/8BAA739F-B195-446C-A6B4-C103296EBF70/d/SuperCollider.app/Contents/Resources/SCClassLibrary/Common/Collections/Dictionary.sc'>Dictionary.sc</a></div><div id='subclasses'>Subclasses: <a href="../Classes/Environment.html">Environment</a>, <a href="../Classes/NodeMap.html">NodeMap</a></div>
<div id='related'>See also: <a href="./../Classes/Environment.html">Environment</a>, <a href="./../Classes/Event.html">Event</a></div>
</div>
<h2><a class='anchor' name='description'>Description</a></h2>

<p>An IdentityDictionary is an associative collection mapping keys to values. Keys and values can be arbitrary objects, but for keys, often a <a href="./../Classes/Symbol.html">Symbol</a> is used.
<p>Often, the subclass <a href="./../Classes/Event.html">Event</a> is used as an IdentityDictionary, because there is a syntactical shortcut:<pre class='code prettyprint lang-sc'>a = (); // return a new Event.
a.put(\foo, 2.718);
a.at(\foo);</pre>
<div class='note'><span class='notelabel'>NOTE:</span> Keys match only if they are <strong>identical objects</strong>. (i.e. === returns true. In Dictionary, keys match if they are equal valued. This makes IdentityDictionary faster than <a href="./../Classes/Dictionary.html">Dictionary</a>)
<p>The contents of a Dictionary are <strong>unordered</strong>. You must not depend on the order of items in a Dictionary.</div>
<p>IdentityDictionary is often used to assign names to instances of a particular class. For example, the proxy classes ( <a href="./../Classes/Pdef.html">Pdef</a>, <a href="./../Classes/Pdefn.html">Pdefn</a>, <a href="./../Classes/Tdef.html">Tdef</a>, <a href="./../Classes/Ndef.html">Ndef</a> ), and <a href="./../Classes/NodeWatcher.html">NodeWatcher</a> all have class variables named all implemented as IdentityDictionaries.<h3><a class='anchor' name=''parent'%20and%20'proto'%20variables'>'parent' and 'proto' variables</a></h3>

<p>IdentityDictionary has three levels of content: the dictionary itself, a <code class='code prettyprint lang-sc'>proto</code>, and a <code class='code prettyprint lang-sc'>parent</code>. <code class='code prettyprint lang-sc'>proto</code> and <code class='code prettyprint lang-sc'>parent</code> exist primarily for IdentityDictionary's subclass <a href="./../Classes/Event.html">Event</a>, which uses the <code class='code prettyprint lang-sc'>parent</code> to store action functions that will be used when an event is played. Users may put additional default values into the <code class='code prettyprint lang-sc'>proto</code>.
<p>Looking up a key within a dictionary first checks the dictionary itself. If the key is not found at this level, it looks in the <code class='code prettyprint lang-sc'>proto</code>, and if still not found, it looks in the parent.
<p>These extra levels are meant for common, default values that should be the same across many dictionary instances.<ul>
<li><code class='code prettyprint lang-sc'>proto</code> and <code class='code prettyprint lang-sc'>parent</code> values are not shown when posting the dictionary.<li>Copying an IdentityDictionary transfers a reference to the parent and proto into the copy. It is a reference, not a copy: changing the copy's parent also affects the parent of the original. This is for efficiency.<li>Iteration operations (<a href="./../Classes/Dictionary.html#-do">Dictionary: -do</a>, <a href="./../Classes/Dictionary.html#-keysValuesDo">Dictionary: -keysValuesDo</a>) only touch the main-level values.<li><a href="./../Classes/Dictionary.html#-collect">Dictionary: -collect</a>, <a href="./../Classes/Dictionary.html#-select">Dictionary: -select</a>, and <a href="./../Classes/Dictionary.html#-reject">Dictionary: -reject</a> return new dictionaries. The parent and proto will be preserved <em>as is</em> in the new result, but -- as with <code class='code prettyprint lang-sc'>do</code> -- they will not be processed in the iteration, and as with <code class='code prettyprint lang-sc'>copy</code>, they are identical references.</ul>
<pre class='code prettyprint lang-sc'>// 'b' is not posted
e = IdentityDictionary(8,
    parent: IdentityDictionary[\b -&gt; 10]
).put(\a, 5);
-&gt; IdentityDictionary[ (a -&gt; 5) ]

// But 'b' is still there
e[\a] + e[\b]
-&gt; 15

// Iteration touches 'a' only
e.keysValuesDo { |key, value| [key, value].postln };
-&gt; [ a, 5 ]

// 'collect' is also an iteration, and doesn't touch the parent
g = e.collect { |x| x * 5 };
-&gt; IdentityDictionary[ (a -&gt; 25) ]
g[\b]
-&gt; 10

// The parent goes into a copy as well
g = e.copy;
g[\b]

// But it's by reference: 'e' and 'g' have the same parent
g.parent[\b] = 20;
e[\b]
-&gt; 20</pre>
<h2><a class='anchor' name='classmethods'>Class Methods</a></h2>
<h3 class='method-code'><span class='method-prefix'>IdentityDictionary.</span><a class='method-name' name='*new' href='./../Overviews/Methods.html#new'>new</a>(<span class='argstr'>n: 8</span>, <span class='argstr'>proto</span>, <span class='argstr'>parent</span>, <span class='argstr'>know: false</span>)</h3>
<div class='method'>
<p>The <a href="#-parent">-parent</a> and <a href="#-proto">-proto</a> instance variables allow additional IdentityDictionary's to provide default values. The precedence order for determining the value of a key is the IdentityDictionary, its prototype, its parent.
<p>When the instance variable <a href="#-know">-know</a> is <a href="./../Classes/True.html">True</a>, the IdentityDictionary responds to unknown messages by looking up the selector and evaluating the result with the dictionary as an argument. For example:<pre class='code prettyprint lang-sc'>a = IdentityDictionary(know: true);
a.put(\foo, { | x, y | "--".postln; ("x:" ++ x).postln;  ("y:" ++ y).postln; y.squared });
a.foo(-10.01);</pre>
<div class='warning'><span class='warninglabel'>WARNING:</span> Only keys that are not already instance methods of IdentityDictionary (or its superclasses) can be used in such a way. E.g. the key "free" will not work, because it is implemented in Object. This means that class extensions (see: <a href="./../Guides/WritingClasses.html">Writing Classes</a>) can break code. It is advisable to use underscores in method names to make this improbable.</div>
<p>In the subclass <a href="./../Classes/Event.html">Event</a>, "know" is true by default, so that it can be instantly used for prototype objects. The first argument passed to the functions is in such cases always the dictionary/event itself (here denoted by "self").<pre class='code prettyprint lang-sc'>a = (some_value: 7, fuzzy_plus: { |self, a, b| a + b * rrand(0.9, 1.1) });
a.some_value; // returns 7
a.some_value = 8; // sets it to 8
a.fuzzy_plus(7, 4);</pre>
</div><h3><a class='anchor' name='Inherited%20class%20methods'>Inherited class methods</a></h3>
<div id='inheritedclassmets'></div><h2><a class='anchor' name='instancemethods'>Instance Methods</a></h2>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-know' href='./../Overviews/Methods.html#know'>know</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-know' href='./../Overviews/Methods.html#know'>know</a> = value</h3>
<div class='method'>
<p>If set to true, the dictionary interprets method calls as look ups. This allows you to implement object prototypes (see above).</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-putGet' href='./../Overviews/Methods.html#putGet'>putGet</a>(<span class='argstr'>key</span>, <span class='argstr'>value</span>)</h3>
<div class='method'>
<p>Sets key to newValue, returns the previous value of key.<pre class='code prettyprint lang-sc'>a = (z: 100);
x = a.putGet(\z, -1); // x is now 100</pre>
</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-includesKey' href='./../Overviews/Methods.html#includesKey'>includesKey</a>(<span class='argstr'>key</span>)</h3>
<div class='method'>
<p>Returns true if the key exists in the dictionary<pre class='code prettyprint lang-sc'>(j:8).includesKey(\j) // true</pre>
</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-findKeyForValue' href='./../Overviews/Methods.html#findKeyForValue'>findKeyForValue</a>(<span class='argstr'>argValue</span>)</h3>
<div class='method'>
<p>Returns the key for a given value (it'll return the first it finds, so this may be ambiguous).<pre class='code prettyprint lang-sc'>(j:8, k: 9).findKeyForValue(8); // returns \j</pre>

<p>If such reverse lookup is needed a lot, for efficiency you may consider using a <a href="./../Classes/TwoWayIdentityDictionary.html">TwoWayIdentityDictionary</a> instead.</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-proto' href='./../Overviews/Methods.html#proto'>proto</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-proto' href='./../Overviews/Methods.html#proto'>proto</a> = value</h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-parent' href='./../Overviews/Methods.html#parent'>parent</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-parent' href='./../Overviews/Methods.html#parent'>parent</a> = value</h3>
<div class='method'>
<p>The two instance variables proto and parent may hold dictionaries which are used to look up all those keys that have no value in the current dictionary. First, proto is looked up, then parent. In other words: proto overrides parent. This allows you to construct systems with complex defaults or multiple inheritance.<pre class='code prettyprint lang-sc'>x = (freq: 30);
a = (amp: 1).parent_(x);
a.at(\freq); // returns 30
a.proto_((freq: 20));
a.at(\freq); // returns 20
y = (i: -1);
b.parent_(y);
a.at(\i); // returns -1
a.cs;</pre>
<div class='image'><img src='IdentityDictionary_02.png'/><br><b>Setting the parent of a dictionary.</b></div>
<pre class='code prettyprint lang-sc'>x = (freq: 30);
a = (amp: 1).parent_(x);
y = (freq: 300);
b = (amp: 0.5).parent_(y);
a.parent_(b);
a.at(\freq); // returns 300
a.cs;</pre>
<div class='image'><img src='IdentityDictionary_01.png'/><br><b>Example schema: order of overriding in proto and parent.</b></div>
</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-insertParent' href='./../Overviews/Methods.html#insertParent'>insertParent</a>(<span class='argstr'>newParent</span>, <span class='argstr'>insertionDepth: 0</span>, <span class='argstr'>reverseInsertionDepth: inf</span>)</h3>
<div class='method'>
<p>Inserts a dictionary into the chain of parents of the receiver (rather than replacing the parent).<h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>newParent<td class='argumentdesc'>
<p>The dictionary that is added to the parent chain<tr><td class='argumentname'>insertionDepth<td class='argumentdesc'>
<p>Level at which the new parent is inserted. Zero (default) means directly above, Inf means at the top of the parent chain.<tr><td class='argumentname'>reverseInsertionDepth<td class='argumentdesc'>
<p>If the new parent dictionary has parents itself, this parameter specifies where the original parents are placed in the new parent chain. Zero means directly above, Inf (default) means at the top of the chain.<div class='image'><img src='IdentityDictionary_03.png'/><br><b>Compare a.insertParent(b, 0) and a.insertParent(b, 1)</b></div>
<div class='image'><img src='IdentityDictionary_04.png'/><br><b>Compare a.insertParent(b, 0, inf) and a.insertParent(b, 0, 0)</b></div>
</table></div><h3><a class='anchor' name='Timing%20support%20(Quant)'>Timing support (Quant)</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-nextTimeOnGrid' href='./../Overviews/Methods.html#nextTimeOnGrid'>nextTimeOnGrid</a>(<span class='argstr'>clock</span>)</h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-asQuant' href='./../Overviews/Methods.html#asQuant'>asQuant</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-timingOffset' href='./../Overviews/Methods.html#timingOffset'>timingOffset</a></h3>
<div class='method'>
<p>Use a dictionary to represent timing information.<pre class='code prettyprint lang-sc'>(
SynthDef(\help_sinegrain,
    { arg out=0, freq=440, sustain=0.05;
        var env;
        env = EnvGen.kr(Env.perc(0.01, sustain, 0.2), doneAction: Done.freeSelf);
        Out.ar(out, SinOsc.ar(freq, 0.5pi, env))
    }).add;

a = Pbind(\instrument, \help_sinegrain, \note, Pseq([0, 7, 2, 9, 11, 10, 9, 8], inf), \dur, 1);
a.play(quant:(quant: 1, phase: 0));
a.play(quant:(quant: 1, phase: 1/3));
a.play(quant:(quant: 1, phase: 1.0.rand));
)</pre>
</div><h3><a class='anchor' name='Garbage%20collection'>Garbage collection</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-freezeAsParent' href='./../Overviews/Methods.html#freezeAsParent'>freezeAsParent</a></h3>
<div class='method'>
<p>For optimizing the garbage collector load, objects can be frozen and become immutable. This method creates a new dictionary with the frozen instance as a parent so that all contents can be overwritten without losing this optimization.</div><h3><a class='anchor' name='Inherited%20instance%20methods'>Inherited instance methods</a></h3>
<div id='inheritedinstmets'></div><h3><a class='anchor' name='Undocumented%20instance%20methods'>Undocumented instance methods</a></h3>
<h3 class='method-code'><span class='method-prefix'></span><a class='method-name' name='-==' href='./../Overviews/Methods.html#=='>==</a>(<span class='argstr'>that</span>)</h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-at' href='./../Overviews/Methods.html#at'>at</a>(<span class='argstr'>key</span>)</h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-collect' href='./../Overviews/Methods.html#collect'>collect</a>(<span class='argstr'>function</span>)</h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-doesNotUnderstand' href='./../Overviews/Methods.html#doesNotUnderstand'>doesNotUnderstand</a>(<span class='argstr'>selector</span> <span class='argstr'>... args</span>)</h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-hash' href='./../Overviews/Methods.html#hash'>hash</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-put' href='./../Overviews/Methods.html#put'>put</a>(<span class='argstr'>key</span>, <span class='argstr'>value</span>)</h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-reject' href='./../Overviews/Methods.html#reject'>reject</a>(<span class='argstr'>function</span>)</h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-scanFor' href='./../Overviews/Methods.html#scanFor'>scanFor</a>(<span class='argstr'>argKey</span>)</h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-select' href='./../Overviews/Methods.html#select'>select</a>(<span class='argstr'>function</span>)</h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-storeItemsOn' href='./../Overviews/Methods.html#storeItemsOn'>storeItemsOn</a>(<span class='argstr'>stream</span>, <span class='argstr'>itemsPerLine: 5</span>)</h3>
<div class='doclink'>helpfile source: <a href='file:///private/var/folders/qf/zrk81q7s6ygdbbgwm1_h5gc80000gn/T/AppTranslocation/8BAA739F-B195-446C-A6B4-C103296EBF70/d/SuperCollider.app/Contents/Resources/HelpSource/Classes/IdentityDictionary.schelp'>/private/var/folders/qf/zrk81q7s6ygdbbgwm1_h5gc80000gn/T/AppTranslocation/8BAA739F-B195-446C-A6B4-C103296EBF70/d/SuperCollider.app/Contents/Resources/HelpSource/Classes/IdentityDictionary.schelp</a><br>link::Classes/IdentityDictionary::<br></div></div></body></html>
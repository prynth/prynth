<html><head><title>Button</title>
<link rel='stylesheet' href='./../scdoc.css' type='text/css' />
<link rel='stylesheet' href='./../frontend.css' type='text/css' />
<link rel='stylesheet' href='./../custom.css' type='text/css' />
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<script src='./../scdoc.js' type='text/javascript'></script>
<script src='./../docmap.js' type='text/javascript'></script>
<script src='./../prettify.js' type='text/javascript'></script>
<script src='./../lang-sc.js' type='text/javascript'></script>
<script type='text/javascript'>var helpRoot='./..';</script>
</head>
<ul id='menubar'></ul>
<body onload='fixTOC();prettyPrint()'>
<div class='contents'>
<div class='header'>
<div id='label'>SuperCollider CLASSES</div>
<div id='categories'><a href='./../Browse.html#GUI>Views'>GUI>Views</a></div>
<h1>Button</h1>
<div id='summary'>A multi-state button</div>
</div>
<div class='subheader'>
<div id='filename'>Source: /usr/local/share/SuperCollider/SCClassLibrary/Common/GUI/Base/<a href='file:///usr/local/share/SuperCollider/SCClassLibrary/Common/GUI/Base/BasicViews.sc'>BasicViews.sc</a></div><div id='superclasses'>Inherits from: <a href="../Classes/View.html">View</a> : <a href="../Classes/QObject.html">QObject</a> : <a href="../Classes/Object.html">Object</a></div>
<div id='subclasses'>Subclasses: <a href="../Classes/QButton.html">QButton</a></div>
</div>
<div id='toc'>
<ul class='toc'><li class='toc1'><a href='#description'>Description</a></li>
<ul class='toc'><li class='toc2'><a href='#Some Important Issues Regarding Button'>Some Important Issues Regarding Button</a></li>
<ul class='toc'></ul></ul><li class='toc1'><a href='#classmethods'>Class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*new'>new</a> </li>
<li class='toc2'><a href='#Inherited class methods'>Inherited class methods</a></li>
<li class='toc2'><a href='#Undocumented class methods'>Undocumented class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*qtClass'>qtClass</a> </li>
</ul></ul><li class='toc1'><a href='#instancemethods'>Instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-states'>states</a> </li>
<li class='toc3'><a href='#-value'>value</a> </li>
<li class='toc3'><a href='#-valueAction'>valueAction</a> </li>
<li class='toc3'><a href='#-string'>string</a> </li>
<li class='toc3'><a href='#-font'>font</a> </li>
<li class='toc2'><a href='#Subclassing and Internal Methods'>Subclassing and Internal Methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-doAction'>doAction</a> </li>
<li class='toc3'><a href='#-defaultKeyDownAction'>defaultKeyDownAction</a> </li>
<li class='toc3'><a href='#-properties'>properties</a> </li>
<li class='toc3'><a href='#-defaultGetDrag'>defaultGetDrag</a> </li>
<li class='toc3'><a href='#-defaultCanReceiveDrag'>defaultCanReceiveDrag</a> </li>
<li class='toc3'><a href='#-defaultReceiveDrag'>defaultReceiveDrag</a> </li>
</ul><li class='toc2'><a href='#Inherited instance methods'>Inherited instance methods</a></li>
<li class='toc2'><a href='#Undocumented instance methods'>Undocumented instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-action'>action</a> </li>
<li class='toc3'><a href='#-prDoAction'>prDoAction</a> </li>
</ul></ul><li class='toc1'><a href='#examples'>Examples</a></li>
<ul class='toc'></ul></ul></div><h2><a class='anchor' name='description'>Description</a></h2>

<p>A multi-state button.<h3><a class='anchor' name='Some Important Issues Regarding Button'>Some Important Issues Regarding Button</a></h3>

<p>Failure to set any states at all results in an invisible button.
<p>The button performs its action upon releasing the mouse. In musical contexts, you might want to use <code class='code prettyprint lang-sc'>mouseDownAction_()</code> to set a function to be performed on pressing the mouse (see <a href="./../Classes/View.html">View</a>, and examples below).
<p>If the drag contains a number, then <code class='code prettyprint lang-sc'>valueAction_()</code> is performed using the <code class='code prettyprint lang-sc'>currentDrag</code>. If the drag contains anything else, <code class='code prettyprint lang-sc'>action</code> is set to the current drag. You could, for example, drag a function to an Button, and action would then be set to that function.<h2><a class='anchor' name='classmethods'>Class Methods</a></h2>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*new' href='./../Overviews/Methods.html#new'>new</a> (<span class='argstr'>parent</span>, <span class='argstr'>bounds</span>)</h3>
<div class='supmethod'>From superclass: <a href='./../Classes/View.html'>View</a></div>
<div class='method'><h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>parent<td class='argumentdesc'>
<p>The parent view.<tr><td class='argumentname'>bounds<td class='argumentdesc'>
<p>An instance of <a href="./../Classes/Rect.html">Rect</a>, or a <a href="./../Classes/Point.html">Point</a> indicating <code class='code prettyprint lang-sc'>width@height</code>.</table><h4>Discussion:</h4>

<p>Example:<pre class='code prettyprint lang-sc'>(
w = Window.new("The Four Noble Truths");

b = Button(w, Rect(20, 20, 340, 30))
        .states_([
            ["there is suffering", Color.black, Color.red],
            ["the origin of suffering", Color.white, Color.black],
            ["the cessation of suffering", Color.red, Color.white],
            ["there is a path to cessation of suffering", Color.blue, Color.clear]
        ])
        .action_({ arg butt;
            butt.value.postln;
        });
w.front;
)</pre>
</div><h3><a class='anchor' name='Inherited class methods'>Inherited class methods</a></h3>
<div id='inheritedclassmets'></div><h3><a class='anchor' name='Undocumented class methods'>Undocumented class methods</a></h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*qtClass' href='./../Overviews/Methods.html#qtClass'>qtClass</a> </h3>
<h2><a class='anchor' name='instancemethods'>Instance Methods</a></h2>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-states' href='./../Overviews/Methods.html#states'>states</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-states' href='./../Overviews/Methods.html#states'>states</a> = <span class='argstr'>stateArray</span></h3>
<div class='method'>
<p>An array of labels and colors defining the states of the button.<h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>stateArray<td class='argumentdesc'>
<p>An <a href="./../Classes/Array.html">Array</a> of arrays of the form <code class='code prettyprint lang-sc'>[ [String, strColor, bgColor] , .... ]</code><pre class='code prettyprint lang-sc'>(
w = Window.new;
a = Button(w, Rect(130, 130, 100, 100));
w.front;
)

// change the states:
a.states = [["yes", Color.grey, Color.white], ["no", Color.white, Color.grey]];
a.states = [["yes", Color.grey, Color.white], ["no", Color.white, Color.grey], ["perhaps", Color.black, Color.green(0.8)], []];

// change the states on action:
(
a.action = { |view|
    if(view.value == 3) { a.states =  [[["yes", "no"].choose, Color.grey, Color.white]] }
}
);</pre>
</table></div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-value' href='./../Overviews/Methods.html#value'>value</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-value' href='./../Overviews/Methods.html#value'>value</a> = <span class='argstr'>argVal</span></h3>
<div class='method'>
<p>Sets or returns the index of the current state. This will <strong>not</strong> evaluate the function assigned to <strong>action</strong> (see <a href="./../Classes/View.html">View</a>).<h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>argVal<td class='argumentdesc'>
<p>The index of an item in the states array.</table></div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-valueAction' href='./../Overviews/Methods.html#valueAction'>valueAction</a><h3 class='imethodname'><span class='methprefix'>-</span><a name='-valueAction' href='./../Overviews/Methods.html#valueAction'>valueAction</a> = <span class='argstr'>anInt</span></h3>
<div class='method'>
<p>Sets the button to display the item at index <strong>anInt</strong> of the states array, and evaluates <strong>action</strong> (see <a href="./../Classes/View.html">View</a>), if the value has changed.<h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>anInt<td class='argumentdesc'>
<p>The index of an item in the states array.</table></div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-string' href='./../Overviews/Methods.html#string'>string</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-string' href='./../Overviews/Methods.html#string'>string</a> = <span class='argstr'>string</span></h3>
<div class='method'>
<p>Sets or gets the text of the currently active state.<pre class='code prettyprint lang-sc'>(
w = Window("but", Rect(300, 300, 200, 200)).front;
b = Button(w, Rect(30, 40, 140, 50));
b.string = "hello button";
)</pre>
</div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-font' href='./../Overviews/Methods.html#font'>font</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-font' href='./../Overviews/Methods.html#font'>font</a> = <span class='argstr'>f</span></h3>
<div class='supmethod'>From superclass: <a href='./../Classes/View.html'>View</a></div>
<div class='method'>
<p>Sets the Font of the button. Default value is the default font: Font.default .<h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>f<td class='argumentdesc'>
<p>An instance of <a href="./../Classes/Font.html">Font</a>.</table></div><h3><a class='anchor' name='Subclassing and Internal Methods'>Subclassing and Internal Methods</a></h3>

<p>The following methods are usually not used directly or are called by a primitive. Programmers can still call or override these as needed.<h3 class='imethodname'><span class='methprefix'>-</span><a name='-doAction' href='./../Overviews/Methods.html#doAction'>doAction</a> (<span class='argstr'>modifiers</span>)</h3>
<div class='method'>
<p>The method called by the primitive upon releasing the mouse.<h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>modifiers<td class='argumentdesc'>
<p>A key modifier number, which is passed to the <strong>action</strong> as its second argument upon mouse-releasing the button.</table></div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-defaultKeyDownAction' href='./../Overviews/Methods.html#defaultKeyDownAction'>defaultKeyDownAction</a> (<span class='argstr'>char</span>, <span class='argstr'>modifiers</span>, <span class='argstr'>unicode</span>, <span class='argstr'>keycode</span>, <span class='argstr'>key</span>)</h3>
<div class='supmethod'>From superclass: <a href='./../Classes/View.html'>View</a></div>
<div class='method'><h4>Discussion:</h4>

<p>The default keydown actions are:<table>
<tr><td>key<td>action<td>comment<tr><td>" "<td>value + 1<td>space<tr><td>\r<td>value + 1<tr><td>\n<td>value + 1<tr><td>3.asAscii<td>value + 1<td>enter key or cmd-C on Mac OSX</table>

<p>To change these use <code class='code prettyprint lang-sc'>defaultKeyDownAction_</code>, see <a href="./../Classes/View.html">View</a>.</div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-properties' href='./../Overviews/Methods.html#properties'>properties</a> </h3>
<div class='supmethod'>From superclass: <a href='./../Classes/QObject.html'>QObject</a></div>
<div class='method'>
<p>A list of properties to which this view responds. See <a href="./../Classes/View.html">View</a>.<h4>Returns:</h4>
<div class='returnvalue'>
<p>[ \bounds, \visible, \enabled, \canFocus, \resize, \background, \minWidth, \maxWidth, \minHeight, \maxHeight, \value, \font, \states, \focusColor ]</div></div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-defaultGetDrag' href='./../Overviews/Methods.html#defaultGetDrag'>defaultGetDrag</a> </h3>
<div class='method'>
<p>The method called by default when initiating a drag <strong>from</strong> a Button. Returns the same as <a href="#-value">-value</a>.</div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-defaultCanReceiveDrag' href='./../Overviews/Methods.html#defaultCanReceiveDrag'>defaultCanReceiveDrag</a> </h3>
<div class='method'>
<p>The method called by default when attempting to drop a drag in this object. By default, Button will respond only to drags where the drag contains a <a href="./../Classes/Number.html">Number</a> or <a href="./../Classes/Function.html">Function</a>.</div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-defaultReceiveDrag' href='./../Overviews/Methods.html#defaultReceiveDrag'>defaultReceiveDrag</a> </h3>
<div class='method'>
<p>The default method called when a drag has been received. If the drag contains a number, then action is set to the current drag. Otherwise <code class='code prettyprint lang-sc'>valueAction_()</code> is performed using the <code class='code prettyprint lang-sc'>currentDrag</code>.</div><h3><a class='anchor' name='Inherited instance methods'>Inherited instance methods</a></h3>
<div id='inheritedinstmets'></div><h3><a class='anchor' name='Undocumented instance methods'>Undocumented instance methods</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-action' href='./../Overviews/Methods.html#action'>action</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-action' href='./../Overviews/Methods.html#action'>action</a> = <span class='argstr'>func</span></h3>
<div class='supmethod'>From superclass: <a href='./../Classes/View.html'>View</a></div>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-prDoAction' href='./../Overviews/Methods.html#prDoAction'>prDoAction</a> (<span class='argstr'>mods</span>)</h3>
<h2><a class='anchor' name='examples'>Examples</a></h2>
<pre class='code prettyprint lang-sc'>(
w = Window.new("Example");

b = Button(w, Rect(90, 20, 200, 30))
        .states_([
            ["sine", Color.black, Color.rand],
            ["saw", Color.black, Color.rand],
            ["noise", Color.black, Color.rand],
            ["pulse", Color.black, Color.rand]
        ])
        .action_({ arg butt;
            butt.value.postln;
        });
w.front;
)

// does not do action
b.value = 2;

// does action if it results in a change of value
b.valueAction = 3;

// clips to size of states
b.valueAction = -1;

// floats no problem
b.valueAction = 3.3;</pre>

<p>In a musical context, a button-down press is more meaningful than a button-up (release) as it's more intuitive to press a button on the beat. For that you can use <a href="./../Classes/View.html">View</a>'s <a href="./../Classes/View.html#mouseDownAction">View: mouseDownAction</a> (a superclass of Button).<pre class='code prettyprint lang-sc'>(
s.waitForBoot({
    w = Window.new;
    b = Button(w, Rect(20, 20, 80, 26))
            .states_([["play", Color.black, Color.rand]])
            .mouseDownAction_({
                a = {EnvGen.kr(Env.adsr, doneAction:2) * SinOsc.ar(440, 0, 0.4)}.play;
            })
            .action_({ arg butt, mod;
                a.release(0.3);
            });
    w.front;
})
)</pre>

<p>If you drag a function to a button, the button's action is set to that function. you can us this for swapping functions.<pre class='code prettyprint lang-sc'>(
s.waitForBoot({
    var w, p, snd, b;

    w = Window.new;

    b = Button(w, Rect(20, 20, 80, 26))
            .states_([["start a sound", Color.black, Color.green], ["stop", Color.black, Color.red]])
            .action_({});

    v = VLayoutView(w, Rect(140, 20, 200, 300)); //Group the following views
    StaticText(v, Rect(20, 20, 180, 60))
        .string_("The button does nothing at first, so try dragging a function to the button");

    DragSource(v, Rect(20, 20, 80, 26))
        .object_(
            {|b| (b.value == 1).if{ snd = { SinOsc.ar(440,0,0.6) }.play} { snd.free }; } //a button action function
            )
        .string_("a play sine function").align_(\center).background_(Color.rand);

    DragSource(v, Rect(20, 20, 80, 26))
        .object_(
            {|b| (b.value == 1).if{ snd = { Saw.ar(440,0.4) }.play} { snd.free }; } //a button action function
            )
        .string_("a play saw function").align_(\center).background_(Color.rand);

    DragSource(v, Rect(20, 20, 80, 26))
        .object_(
            {|b| (b.value == 1).if{ snd = { WhiteNoise.ar(0.4) }.play } { snd.free }; } //a button action function
            )
        .string_("a play noise function").align_(\center).background_(Color.rand);

    p = CmdPeriod.add({ b.value_(0) }); // set button to 0 on hitting Cmd-period
    w.onClose_{ snd.free; CmdPeriod.removeAll };//clean up when window is closed
    w.front;
})
)</pre>

<p>Using Routine to set button states on the fly.<pre class='code prettyprint lang-sc'>(
var update, w, b;
    w = Window.new("State Window", Rect(150,Window.screenBounds.height - 140, 380, 60));

    // a convenient way to set the button label
    update = {
        |but, string| but.states = [[string.asString, Color.black, Color.red]];
        but.refresh;
    };

    b = Button(w, Rect(10, 10, 360, 40));
    b.font_(Font("Impact", 24));

    update.value(b, "there is only one state");

    // if an action should do something different each time it is called, a routine is the
    // right thing to use. This is better than creating variables outside and setting them
    // from the action function to keep state from one action to the next

    b.action_(Routine { |butt|
        rrand(15, 45).do { |i|
            update.value(butt, "%. there is still only 1 state".format(i + 2));
            0.yield; // stop here
        };
        w.close;
    });
    w.front;
)</pre>

<p>Using Routine to set button states on the fly 2.<pre class='code prettyprint lang-sc'>(
s.waitForBoot({
    var update, w, b;

    w = Window.new("State Window", Rect(150, Window.screenBounds.height - 140, 380, 60));

    // a convenient way to set the button label
    update = { |but, string|
    but.states = [[string.asString, Color.black, Color.red]]; but.refresh };

    b = Button(w, Rect(10, 10, 360, 40));
    b.font_(Font("Impact", 24));

    update.value(b, "there is only one state");

    // if an action should do something different each time it is called, a routine is the
    // right thing to use. This is better than creating variables outside and setting them
    // from the action function to keep state from one action to the next

    b.action_(Routine { |butt|
        var synth, guessVal;

        update.value(butt, "there are only two states");
        0.yield; // stop here

        update.value(butt, "click me");
        0.yield; // stop here

        update.value(butt, "click me again");
        0.yield; // stop here ..

        // create a synth
        synth = { |freq = 1000, rate = 5|
            Ringz.ar(
                Impulse.ar(rate.lag(4) * [1,1.01]), freq, rrand(0.01, 0.1), 0.3
            )
        }.play;
        0.yield;

        guessVal = exprand(200.0, 18000).round;
        synth.set(\freq, guessVal); // set the synth
        update.value(butt, "?");
        0.yield;

        update.value(butt, guessVal.asString + "Hz"); // display frequency
        0.yield;

        synth.set(\rate, rrand(10, 50)); // set trigger rate
        // start an independent process
        fork({ 5.wait; synth.release; update.value(butt, "."); 1.wait; w.close }, AppClock);
    });
    CmdPeriod.doOnce({w.close});
    w.front;
});
)</pre>

<p>Complex drag and drop example try dragging the buttons to white slot, and then between white slots, or simply out of the view.<pre class='code prettyprint lang-sc'>(
var w, f, slots;
var insert, remove;

slots = Dictionary.new;

remove = {arg slot, id;
    [slot, id].postln;
};

insert = {arg slot, fx;
    if(fx != ""){
        slots["slot"++slot].value_(0).states_([[fx, Color.white, Color.blue]]);
        [slot, fx].postln;
    }{
        slots["slot"++slot].value_(0).states_([["", Color.white, Color.white]]);
        remove.value(slot, fx);
    };
};

w = Window.new("",Rect(200, 400, 448, 180));
w.view.decorator = f = FlowLayout(w.view.bounds);

StaticText(w, 400@20).string_("Drag &amp; Drop holding down Cmd-key");
f.nextLine;
6.do{arg i;
    var fxwin, winOpen = false, empty = ["", Color.white, Color.white];

    slots["slot" ++ i] = Button.new(w, 70@70)
        .states_([empty])
        .action_({|v|
            if((slots["slot" ++ i].states[0][0] != "") &amp;&amp; ( winOpen == false)) {
                fxwin = Window(slots["slot" ++ i].states[0][0], Rect(rrand(0, 500),rrand(0, 500),200, 200)).front;
                fxwin.view.background_(Color.rand);
                fxwin.onClose_({ winOpen = false});
                winOpen = true
            } {
                if(winOpen == true) {
                    fxwin.front
                }
            }; })
        .canReceiveDragHandler_({ View.currentDrag.isString })
        .receiveDragHandler_({ insert.value(i, View.currentDrag) })
        .beginDragAction_({
            var drag;
            drag = slots["slot" ++ i].states[0][0];
            slots["slot" ++ i].value_(0).states_([empty]);
            remove.value(i, View.currentDrag);
            drag; })
        .keyDownAction_({ arg view,char,modifiers,unicode,keycode;
            switch(keycode)
                { 51 } {
                    slots["slot"++i].value_(0).states_([empty]);
                    slots["slot"++i].refresh;
                    remove.value(i, View.currentDrag);
                }; });
};

f.nextLine;

["a", "b", "c", "d", "e", "f"].do{ arg item, i;
    Button.new(w, 70@70)
    .states_([ [ item ] ])
    .action_({ |v| })
    .beginDragAction_({item})
};
w.front;
)</pre>

<p><div class='doclink'>source: <a href='file:///usr/local/share/SuperCollider/HelpSource/Classes/Button.schelp'>/usr/local/share/SuperCollider/HelpSource/Classes/Button.schelp</a><br>link::Classes/Button::<br>sc version: 3.8dev</div></div></body></html>
<!doctype html><html lang='en'><head><title>History | SuperCollider 3.11.2 Help</title>
<link rel='stylesheet' href='./../scdoc.css' type='text/css' />
<link rel='stylesheet' href='./../codemirror.css' type='text/css' />
<link rel='stylesheet' href='./../editor.css' type='text/css' />
<link rel='stylesheet' href='./../frontend.css' type='text/css' />
<link rel='stylesheet' href='./../custom.css' type='text/css' />
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<script src='./../lib/jquery.min.js'></script>
<script src='./../lib/codemirror-5.39.2.min.js' type='text/javascript'></script>
<script src='./../lib/codemirror-addon-simple-5.39.2.min.js' type='text/javascript'></script>
<script>
var helpRoot = './..';
var scdoc_title = 'History';
var scdoc_sc_version = '3.11.2';
</script>
<script src='./../scdoc.js' type='text/javascript'></script>
<script src='./../docmap.js' type='text/javascript'></script>
<script src='qrc:///qtwebchannel/qwebchannel.js' type='text/javascript'></script>
</head>
<body onload='fixTOC()'>
<div id='toc'>
<div id='toctitle'>History:</div>
<span class='toc_search'>Filter: <input id='toc_search'></span><ul class='toc'><li class='toc1'><a href='#description'>Description</a></li>
<ul class='toc'></ul><li class='toc1'><a href='#classmethods'>Class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*start'>start</a> </li>
<li class='toc3'><a href='#*end'>end</a> </li>
<li class='toc3'><a href='#*started'>started</a> </li>
<li class='toc3'><a href='#*document'>document</a> </li>
<li class='toc3'><a href='#*current'>current</a> </li>
<li class='toc3'><a href='#*lines'>lines</a>  <a href='#*lineShorts'>lineShorts</a> </li>
<li class='toc3'><a href='#*makeWin'>makeWin</a> </li>
<li class='toc2'><a href='#Configuration'>Configuration</a></li>
<ul class='toc'><li class='toc3'><a href='#*keepsLog'>keepsLog</a> </li>
<li class='toc3'><a href='#*verbose'>verbose</a> </li>
<li class='toc3'><a href='#*recordLocally'>recordLocally</a> </li>
<li class='toc3'><a href='#*localOff'>localOff</a>  <a href='#*localOn'>localOn</a> </li>
<li class='toc3'><a href='#*forwardFunc'>forwardFunc</a> </li>
</ul><li class='toc2'><a href='#Save%20and%20load%20history%20logs'>Save and load history logs</a></li>
<ul class='toc'><li class='toc3'><a href='#*showLogFolder'>showLogFolder</a> </li>
<li class='toc3'><a href='#*showLogFile'>showLogFile</a> </li>
<li class='toc3'><a href='#*saveCS'>saveCS</a> </li>
<li class='toc3'><a href='#*loadCS'>loadCS</a> </li>
<li class='toc3'><a href='#*saveStory'>saveStory</a> </li>
<li class='toc3'><a href='#*loadStory'>loadStory</a> </li>
<li class='toc3'><a href='#*rewrite'>rewrite</a> </li>
<li class='toc3'><a href='#*readFromDoc'>readFromDoc</a> </li>
</ul><li class='toc2'><a href='#Editing%20history'>Editing history</a></li>
<ul class='toc'><li class='toc3'><a href='#*clear'>clear</a> </li>
<li class='toc3'><a href='#*enter'>enter</a> </li>
<li class='toc3'><a href='#*drop'>drop</a> </li>
<li class='toc3'><a href='#*keep'>keep</a> </li>
<li class='toc3'><a href='#*removeAt'>removeAt</a> </li>
<li class='toc3'><a href='#*removeLast'>removeLast</a> </li>
</ul><li class='toc2'><a href='#Repeating%20history'>Repeating history</a></li>
<ul class='toc'><li class='toc3'><a href='#*ignoreErrors'>ignoreErrors</a> </li>
<li class='toc3'><a href='#*eval'>eval</a> </li>
<li class='toc3'><a href='#*evalLineAt'>evalLineAt</a> </li>
<li class='toc3'><a href='#*play'>play</a> </li>
<li class='toc3'><a href='#*stop'>stop</a> </li>
</ul><li class='toc2'><a href='#Date,%20time,%20string%20functions'>Date, time, string functions</a></li>
<ul class='toc'><li class='toc3'><a href='#*startTimeStamp'>startTimeStamp</a> </li>
<li class='toc3'><a href='#*formatTime'>formatTime</a> </li>
<li class='toc3'><a href='#*unformatTime'>unformatTime</a> </li>
<li class='toc3'><a href='#*shorten'>shorten</a> </li>
<li class='toc3'><a href='#*prettyString'>prettyString</a> </li>
<li class='toc3'><a href='#*new'>new</a> </li>
</ul><li class='toc2'><a href='#Inherited%20class%20methods'>Inherited class methods</a></li>
<li class='toc2'><a href='#Undocumented%20class%20methods'>Undocumented class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*playCmdPeriod'>playCmdPeriod</a> </li>
</ul></ul><li class='toc1'><a href='#instancemethods'>Instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-isCurrent'>isCurrent</a> </li>
<li class='toc3'><a href='#-makeCurrent'>makeCurrent</a> </li>
<li class='toc3'><a href='#-player'>player</a> </li>
<li class='toc3'><a href='#-keys'>keys</a> </li>
<li class='toc3'><a href='#-addLine'>addLine</a> </li>
<li class='toc3'><a href='#-indicesFor'>indicesFor</a> </li>
<li class='toc2'><a href='#Inherited%20instance%20methods'>Inherited instance methods</a></li>
</ul><li class='toc1'><a href='#examples'>Examples</a></li>
<ul class='toc'></ul></ul></div><div id='menubar'></div>
<div class='contents'>
<div class='header'>
<div id='label'>
<span id='folder'>Classes</span>
 | <span id='categories'><a href='./../Browse.html#Streams-Patterns-Events'>Streams-Patterns-Events</a></span>
</div><h1>History<span id='superclasses'> : <a href="../Classes/Object.html">Object</a></span>
</h1>
<div id='summary'>keeps a history of interpreted lines of code</div>
</div>
<div class='subheader'>
<div id='filename'>Source: <a href='file:///usr/share/SuperCollider/SCClassLibrary/Common/Streams/History.sc' title='/usr/share/SuperCollider/SCClassLibrary/Common/Streams/History.sc'>History.sc</a></div><div id='related'>See also: <a href="./../Classes/Archive.html">Archive</a></div>
</div>
<h2><a class='anchor' name='description'>Description</a></h2>

<p>History stores all code strings as they are being evaluated, in order to reuse code written earlier, to forward code to other players, or to store, reproduce, edit and analyse live-coded performances. It records every evaluated code string into a singleton instance of History - <code>History.current</code>.
<p>First examples:<textarea class='editor'>History.clear.end;     // if needed, clear History first
History.start;         // starts recording, opens log file

// execute these lines one by one, as a little performance history
1 + 2;
p = ProxySpace.push(s.boot);
~a = {Dust.ar([1,1] * 30 ) * 0.3 };
~a.play;
~a.end(3);

History.started; // is it on now?

// stops recording history and ends logging.
History.end;
History.started;

History.document;      // creates a document with current history
History.showLogFolder; // opens the folder where logs are written.
History.showLogFile;   // opens the current log file as it was written.


// make a gui window, to access code history lines at will,
// e.g. for code reuse in performance, adaptation, sharing, etc:
g = History.makeWin;
// specify left-bottom position, and number of lines in textview
g = History.makeWin(0@20, 5);

// play back the recorded history line by line
History.play(0);


// history can even record and play back stops with CmdPeriod.
// run these lines one at a time:
History.clear.start;
1 + 2;
2 + 3;
s.boot;
(dur: inf).play;

CmdPeriod.run; // or hit the Stop key command, Cmd-., or ctrl-.
3 + 4; // continue recording into history
4 + 5;
History.end;

// Replays history, including a CmdPeriod, and keeps replaying history.
History.play;</textarea>
<h2><a class='anchor' name='classmethods'>Class Methods</a></h2>
<div class='note'><span class='notelabel'>NOTE:</span> Many class methods are redirected to the privileged instance of History, <code>History.current</code>. This is intended to provide a simple code user interface.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*start' href='./../Overviews/Methods.html#start'>start</a></h3>
<div class='method'>
<p>start adding interpreted code to (current) history.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*end' href='./../Overviews/Methods.html#end'>end</a></h3>
<div class='method'>
<p>end adding interpreted code to (current) history.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*started' href='./../Overviews/Methods.html#started'>started</a></h3>
<div class='method'>
<p>boolean whether History is started.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*document' href='./../Overviews/Methods.html#document'>document</a></h3>
<div class='extmethod'>From extension in <a href='file:///usr/share/SuperCollider/SCClassLibrary/Common/GUI/PlusGUI/Core/extGuiHistory.sc'>/usr/share/SuperCollider/SCClassLibrary/Common/GUI/PlusGUI/Core/extGuiHistory.sc</a></div>
<div class='method'>
<p>post the history in a new document (as story). The document title is a string formatted as follows: <code>"%Y-%m-%d-%Hh%M-History"</code>.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*current' href='./../Overviews/Methods.html#current'>current</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*current' href='./../Overviews/Methods.html#current'>current</a> = value</h3>
<div class='method'>
<p>the current History instance</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*lines' href='./../Overviews/Methods.html#lines'>lines</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*lineShorts' href='./../Overviews/Methods.html#lineShorts'>lineShorts</a></h3>
<div class='method'>
<p>the currently recorded lines in History.current. lineShorts is a copy with shortened strings for display.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*makeWin' href='./../Overviews/Methods.html#makeWin'>makeWin</a>(<span class='argstr'>where</span>, <span class='argstr'>numItems: 8</span>)</h3>
<div class='extmethod'>From extension in <a href='file:///usr/share/SuperCollider/SCClassLibrary/Common/GUI/PlusGUI/Core/extGuiHistory.sc'>/usr/share/SuperCollider/SCClassLibrary/Common/GUI/PlusGUI/Core/extGuiHistory.sc</a></div>
<div class='method'>
<p>make a HistoryGui for History.current. argument: where a point that sets left top of the HistoryGui window, argument: numItems the number of lines in the textview</div><h3><a class='anchor' name='Configuration'>Configuration</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*keepsLog' href='./../Overviews/Methods.html#keepsLog'>keepsLog</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*keepsLog' href='./../Overviews/Methods.html#keepsLog'>keepsLog</a> = value</h3>
<div class='method'>
<p>get and set flag whether to log History to a file.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*verbose' href='./../Overviews/Methods.html#verbose'>verbose</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*verbose' href='./../Overviews/Methods.html#verbose'>verbose</a> = value</h3>
<div class='method'>
<p>get and set flag whether to post debug messages from History operations.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*recordLocally' href='./../Overviews/Methods.html#recordLocally'>recordLocally</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*recordLocally' href='./../Overviews/Methods.html#recordLocally'>recordLocally</a> = value</h3>
<div class='method'>
<p>get and set flag to turn recording local code evaluation on and off</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*localOff' href='./../Overviews/Methods.html#localOff'>localOff</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*localOn' href='./../Overviews/Methods.html#localOn'>localOn</a></h3>
<div class='method'>
<p>convenience to turn recording of local code evaluation on and off</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*forwardFunc' href='./../Overviews/Methods.html#forwardFunc'>forwardFunc</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*forwardFunc' href='./../Overviews/Methods.html#forwardFunc'>forwardFunc</a> = value</h3>
<div class='method'>
<p>a function to run on incoming new lines, can be used to send code by network. See the Utopia quark for examples of networking code history.</div><h3><a class='anchor' name='Save%20and%20load%20history%20logs'>Save and load history logs</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*showLogFolder' href='./../Overviews/Methods.html#showLogFolder'>showLogFolder</a></h3>
<div class='method'>
<p>open folder where logfiles are stored</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*showLogFile' href='./../Overviews/Methods.html#showLogFile'>showLogFile</a></h3>
<div class='method'>
<p>open current log file</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*saveCS' href='./../Overviews/Methods.html#saveCS'>saveCS</a>(<span class='argstr'>path</span>, <span class='argstr'>forward: false</span>)</h3>
<div class='method'>
<p>store history as one compileString.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*loadCS' href='./../Overviews/Methods.html#loadCS'>loadCS</a>(<span class='argstr'>path</span>, <span class='argstr'>forward: false</span>)</h3>
<div class='method'>
<p>load a history from (compilestring) file.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*saveStory' href='./../Overviews/Methods.html#saveStory'>saveStory</a>(<span class='argstr'>path</span>)</h3>
<div class='method'>
<p>store in a file, in historical order as individual code snippets.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*loadStory' href='./../Overviews/Methods.html#loadStory'>loadStory</a>(<span class='argstr'>path</span>)</h3>
<div class='method'>
<p>read history into current, from a file in story format.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*rewrite' href='./../Overviews/Methods.html#rewrite'>rewrite</a>(<span class='argstr'>path</span>, <span class='argstr'>open: true</span>)</h3>
<div class='method'>
<p>Write a properly formatted code file from a history.<h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>path<td class='argumentdesc'>
<p>The filename is the original name with "_rewritten." appended.<tr><td class='argumentname'>open<td class='argumentdesc'>
<p>If open is true (default: true), open a text window with the string.</table></div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*readFromDoc' href='./../Overviews/Methods.html#readFromDoc'>readFromDoc</a>(<span class='argstr'>path</span>)</h3>
<div class='method'>
<p>read in a history from a code file created with .rewrite</div><h3><a class='anchor' name='Editing%20history'>Editing history</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*clear' href='./../Overviews/Methods.html#clear'>clear</a></h3>
<div class='method'>
<p>remove all items from (current) history.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*enter' href='./../Overviews/Methods.html#enter'>enter</a>(<span class='argstr'>lineStr</span>, <span class='argstr'>id: 'me'</span>)</h3>
<div class='method'>
<p>add an entry to (current) history by hand.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*drop' href='./../Overviews/Methods.html#drop'>drop</a>(<span class='argstr'>num</span>)</h3>
<div class='method'>
<p>drop the newest num lines from history. if n is negative, drop the oldest n lines.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*keep' href='./../Overviews/Methods.html#keep'>keep</a>(<span class='argstr'>num</span>)</h3>
<div class='method'>
<p>keep only the newest num lines from history. if n is negative, keep the oldest n lines.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*removeAt' href='./../Overviews/Methods.html#removeAt'>removeAt</a>(<span class='argstr'>index</span>)</h3>
<div class='method'>
<p>remove a specific line</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*removeLast' href='./../Overviews/Methods.html#removeLast'>removeLast</a></h3>
<div class='method'>
<p>remove last line from history</div><h3><a class='anchor' name='Repeating%20history'>Repeating history</a></h3>

<p>Repeating history can have different uses: A. Reconstruction, e.g. redoing a history of coding steps as closely as possible, or replaying a full performance as closely as possible; here, all errors are important and should be handled individually. B. Experimental live performance, e.g. replaying snippets from a recorded networked live-coding show in nonlinear orders; here, errors will occur more often because the current state will not always fit with what a particular line would require. Thus, one will likely prefer the robustness to just keep going.<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*ignoreErrors' href='./../Overviews/Methods.html#ignoreErrors'>ignoreErrors</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*ignoreErrors' href='./../Overviews/Methods.html#ignoreErrors'>ignoreErrors</a> = value</h3>
<div class='method'>
<p>global flag whether evaluating code lines via History will ignore errors or stop and throw them.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*eval' href='./../Overviews/Methods.html#eval'>eval</a>(<span class='argstr'>codeString</span>, <span class='argstr'>ignoreError</span>)</h3>
<div class='method'>
<p>evaluate codeString, and optionally, use ignoreError to override global ignoreErrors flag.<textarea class='editor'>History.ignoreErrors = true;
History.eval("2 + 1").postln; // correct code, so is just evaluated
History.eval("2 + qwe"); 123; // compile error, but keeps going and posts 123
History.eval("1.blonk"); 123; // runtime error, keeps going -&gt; posts 123
History.eval("1.blonk", false); 123; // throws error and stops, code after it never happens.</textarea>
</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*evalLineAt' href='./../Overviews/Methods.html#evalLineAt'>evalLineAt</a>(<span class='argstr'>index</span>)</h3>
<div class='method'>
<p>evaluate the line at index in History.current.lines</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*play' href='./../Overviews/Methods.html#play'>play</a>(<span class='argstr'>start: 0</span>, <span class='argstr'>end</span>, <span class='argstr'>verbose: true</span>)</h3>
<div class='method'>
<p>play back current history from start to end line, per default verbose.</div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*stop' href='./../Overviews/Methods.html#stop'>stop</a></h3>
<div class='method'>
<p>stop current history playback.</div><h3><a class='anchor' name='Date,%20time,%20string%20functions'>Date, time, string functions</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*startTimeStamp' href='./../Overviews/Methods.html#startTimeStamp'>startTimeStamp</a></h3>
<div class='method'></div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*formatTime' href='./../Overviews/Methods.html#formatTime'>formatTime</a>(<span class='argstr'>val</span>)</h3>
<div class='method'></div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*unformatTime' href='./../Overviews/Methods.html#unformatTime'>unformatTime</a>(<span class='argstr'>str</span>)</h3>
<div class='method'></div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*shorten' href='./../Overviews/Methods.html#shorten'>shorten</a>(<span class='argstr'>line</span>, <span class='argstr'>maxLength</span>)</h3>
<div class='method'></div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*prettyString' href='./../Overviews/Methods.html#prettyString'>prettyString</a>(<span class='argstr'>str</span>)</h3>
<div class='method'>
<p></div><h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*new' href='./../Overviews/Methods.html#new'>new</a>(<span class='argstr'>lines</span>)</h3>
<div class='method'>
<p>create a new instance containing the lines given.</div><h3><a class='anchor' name='Inherited%20class%20methods'>Inherited class methods</a></h3>
<div id='inheritedclassmets'></div><h3><a class='anchor' name='Undocumented%20class%20methods'>Undocumented class methods</a></h3>
<h3 class='method-code'><span class='method-prefix'>History.</span><a class='method-name' name='*playCmdPeriod' href='./../Overviews/Methods.html#playCmdPeriod'>playCmdPeriod</a></h3>
<h2><a class='anchor' name='instancemethods'>Instance Methods</a></h2>
<div class='note'><span class='notelabel'>NOTE:</span> the instance methods <code>[hasMovedOn_, hasMovedOn, play, stop, lines, lineShorts, removeAt, removeLast, keep, drop, clear, saveCS, loadCS, saveStory, evalLineAt, loadStory, makeWin, document]</code> are also implemented as class methods, and documented above.</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-isCurrent' href='./../Overviews/Methods.html#isCurrent'>isCurrent</a></h3>
<div class='method'>
<p>flag whether this history is History.current</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-makeCurrent' href='./../Overviews/Methods.html#makeCurrent'>makeCurrent</a></h3>
<div class='method'>
<p>make this history History.current</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-player' href='./../Overviews/Methods.html#player'>player</a></h3>
<div class='method'>
<p>the player task for ths history</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-keys' href='./../Overviews/Methods.html#keys'>keys</a></h3>
<div class='method'>
<p>all keys of code authors in this history</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-addLine' href='./../Overviews/Methods.html#addLine'>addLine</a>(<span class='argstr'>now</span>, <span class='argstr'>authID</span>, <span class='argstr'>lineStr</span>)</h3>
<div class='method'>
<p>add a line to history with current time, id, and code string</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-indicesFor' href='./../Overviews/Methods.html#indicesFor'>indicesFor</a>(<span class='argstr'>keys</span>, <span class='argstr'>string: ""</span>)</h3>
<div class='method'>
<p>find line indices created by keys and containing string. used for filtering.</div><h3><a class='anchor' name='Inherited%20instance%20methods'>Inherited instance methods</a></h3>
<div id='inheritedinstmets'></div><h2><a class='anchor' name='examples'>Examples</a></h2>
<textarea class='editor'>// same as first example:
History.clear.end;      // clear to start over
History.start;          // starts recording, opens log file

// execute these lines one by one
1 + 2;
p = ProxySpace.push(s.boot);
~a = {Dust.ar([1,1] * 30 ) * 0.3 };
~a.play;
~a.end;

History.end; // History.end ends logging as well.


History.document; // create a document with all the changes
History.showLogFile; // open the log file as it was written.

g = History.makeWin(0@20); // make a gui window, put it where you like
g = History.makeWin(0@20, 5); // number of lines in textview

History.play;                  // posts lines by default
History.play(verbose: false);  // just do it, no posting

// continue recording
History.start;

// enter 5 more lines
10 + 200;
p.push;
~b = { |freq=500| LFDNoise3.ar(freq.dup(2)) * 0.2 };
~b.play;
~b.set(\freq, 1000);
~b.end(2);

History.end;

// save current history to a file.
History.saveCS("~/Desktop/TestHist.scd");
h = History.new.loadCS("~/Desktop/TestHist.scd");
h.lines.printcsAll; "";

// Many History methods are redirected to History.current:

// History.current is where new codelines always go.
h = History.current;
h.lines.printcsAll; "";

// lineshorts are for gui display:
h.lineShorts.printcsAll; "";

// make a simple entry by hand.
History.enter("2 + 2");
h.lines.printcsAll; "";

// one can edit a history:
History.drop(-1); // drop the oldest memory
History.drop(1); // drop the newest memory

h.keep(9); h.lines.printAll; "";
h.drop(3); h.lines.printAll; "";
h.removeLast;       h.lines.printAll;"";
h.removeAt([3, 4]); h.lines.printAll;"";

// more examples
History.clear.start;

1 + 2; // code lines get stored

(nil + 2).postln; // error lines are ignored

// comment-only line is kept, empty lines not:
History.enter("// comment only");
History.enter(" ");


// save and load as text files

History.saveCS; // save as compilestring for reloading.

// save with name, in forward time order.
History.saveCS("~/Desktop/testHist.scd", forward: true);

// load back in from file
h = History.new.loadCS("~/Desktop/testHist.scd", forward: true);
h.lines.postcs; "";

// save as human-readable/hand-playable story
// write all to time-stamped file in historical order:
History.saveStory;

// ... with given filename.
History.saveStory("~/Desktop/myTestStory.scd");

// load from story format file
History.loadStory("~/Desktop/myTestStory.scd");

Document.open("~/Desktop/myTestStory.scd");    // the story file is human-readable.


// Various Internals
// make a new instance of History by hand:
h = History([
    [0, \me, "1+2"],
    [1.234, \me, "q = q ? ();"],
    [3, \me, "\"History\".postln"]]);
h.lines.printcsAll; "";
h.lineShorts.printcsAll; "";

h.play; // play it back
h.stop;


// string formatting utils
h.storyString;
History.formatTime(1234.56);
History.unformatTime("0:20:34.56");

(
History.prettyString("

/* removes line returns at start and end of code strings ... */

").postcs;
)

// convert a line to a short string of n characters for gui display
History.shorten(h.lines.first.postcs, 60).postcs;


// in networked setups, one may turn off local recording and rely on remote recording:
History.recordLocally
History.localOff
History.recordLocally
History.localOn
History.recordLocally


// by default, history always logs here (and makes the folder if not there yet):
History.logFolder;
History.showLogFolder;
History.logPath;
History.showLogFile; // current logfile...
// todo: optionally, one should be able to turn logging off?

// filtering lines, to get subsets of all lines by key and/or searchstring:

// get indices for specific keys
h = History([[0, \me, "a=1+2"], [1, \me, "3+5"], [1.234, \you, "q = q ? ();"], [3, \her, "\"Herstory ==== \".postln"]]);
h.keys;
h.matchKeys(\me);
h.matchKeys(\you);
h.matchKeys(\her);
h.matchKeys;        // nil if no test
h.matchKeys(\all);  // all keys match
h.matchKeys([\me, \her])
h.matchKeys(\isidor) // empty array if no line found for this key

h.matchString("Herst");
h.matchString("q");
h.matchString("1+");
h.matchString("herStory", false); // ignoreCase is false by default
h.matchString("herStory", true); // ignoreCase

h.indicesFor([\me, \her], "=");    // indices for line written by \me or \her AND containing "=";

// searching is only an interface/access feature,
// so please read on at HistoryGui help ...
h.makeWin;

HistoryGui.help;</textarea>

<p><div class='doclink'>helpfile source: <a href='file:///usr/share/SuperCollider/HelpSource/Classes/History.schelp'>/usr/share/SuperCollider/HelpSource/Classes/History.schelp</a><br>link::Classes/History::<br></div></div><script src='./../editor.js' type='text/javascript'></script>
</body></html>
<!doctype html><html lang='en'><head><title>SOMRd | SuperCollider 3.11.2 Help</title>
<link rel='stylesheet' href='./../scdoc.css' type='text/css' />
<link rel='stylesheet' href='./../codemirror.css' type='text/css' />
<link rel='stylesheet' href='./../editor.css' type='text/css' />
<link rel='stylesheet' href='./../frontend.css' type='text/css' />
<link rel='stylesheet' href='./../custom.css' type='text/css' />
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<script src='./../lib/jquery.min.js'></script>
<script src='./../lib/codemirror-5.39.2.min.js' type='text/javascript'></script>
<script src='./../lib/codemirror-addon-simple-5.39.2.min.js' type='text/javascript'></script>
<script>
var helpRoot = './..';
var scdoc_title = 'SOMRd';
var scdoc_sc_version = '3.11.2';
</script>
<script src='./../scdoc.js' type='text/javascript'></script>
<script src='./../docmap.js' type='text/javascript'></script>
<script src='qrc:///qtwebchannel/qwebchannel.js' type='text/javascript'></script>
</head>
<body onload='fixTOC()'>
<div id='toc'>
<div id='toctitle'>SOMRd:</div>
<span class='toc_search'>Filter: <input id='toc_search'></span><ul class='toc'><li class='toc1'><a href='#description'>Description</a></li>
<ul class='toc'></ul><li class='toc1'><a href='#classmethods'>Class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*kr'>kr</a> </li>
<li class='toc2'><a href='#Inherited%20class%20methods'>Inherited class methods</a></li>
<li class='toc2'><a href='#Undocumented%20class%20methods'>Undocumented class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*ar'>ar</a> </li>
<li class='toc3'><a href='#*bufIndexToCoords'>bufIndexToCoords</a> </li>
<li class='toc3'><a href='#*coordsToBufIndex'>coordsToBufIndex</a> </li>
</ul></ul><li class='toc1'><a href='#instancemethods'>Instance methods</a></li>
<ul class='toc'><li class='toc2'><a href='#Inherited%20instance%20methods'>Inherited instance methods</a></li>
</ul><li class='toc1'><a href='#examples'>Examples</a></li>
<ul class='toc'></ul></ul></div><div id='menubar'></div>
<div class='contents'>
<div class='header'>
<div id='label'>
<span id='folder'>Classes (extension)</span>
 | <span id='categories'><a href='./../Browse.html#UGens'>UGens</a>&#8201;&gt;&#8201;<a href='./../Browse.html#UGens>Analysis'>Analysis</a></span>
</div><h1>SOMRd<span id='superclasses'> : <a href="../Classes/MultiOutUGen.html">MultiOutUGen</a> : <a href="../Classes/UGen.html">UGen</a> : <a href="../Classes/AbstractFunction.html">AbstractFunction</a> : <a href="../Classes/Object.html">Object</a></span>
<div class='extension-indicator-ctr' title='This help file originates from a third-party quark or plugin for SuperCollider.'><img class='extension-indicator-icon' alt='Extension' src='./../images/plugin.png'><span class='extension-indicator-text'>Extension</span></div></h1>
<div id='summary'>Map an input using a Self-Organising Map</div>
</div>
<div class='subheader'>
<div id='filename'>Source: <a href='file:///usr/share/SuperCollider/Extensions/SC3plugins/MCLDUGens/SOMTrain.sc' title='/usr/share/SuperCollider/Extensions/SC3plugins/MCLDUGens/SOMTrain.sc'>SOMTrain.sc</a></div><div id='related'>See also: <a href="./../Classes/SOMTrain.html">SOMTrain</a></div>
</div>
<h2><a class='anchor' name='description'>Description</a></h2>

<p>Once you have created a self-organising map using <a href="./../Classes/SOMTrain.html">SOMTrain</a>, you can query it using SOMRd. This UGen takes an input vector (i.e. multichannel input) and outputs the co-ordinate of the best-matching node in the SOM, i.e. the node which is closest to the input vector (using Euclidean distance). It can run at control- or audio-rate.
<p>For some applications you might want to retrieve the best-matching template vector, i.e. the spatial location of the best-matching node, rather than just its index in the net. You can use SOMRd.coordsToBufIndex(coords, netsize) to find which Buffer frame contains that vector, and then use BufRd to pull the vector out. See examples...<h2><a class='anchor' name='classmethods'>Class Methods</a></h2>
<h3 class='method-code'><span class='method-prefix'>SOMRd.</span><a class='method-name' name='*kr' href='./../Overviews/Methods.html#kr'>kr</a>(<span class='argstr'>bufnum</span>, <span class='argstr'>inputdata</span>, <span class='argstr'>netsize: 10</span>, <span class='argstr'>numdims: 2</span>, <span class='argstr'>gate: 1</span>)</h3>
<div class='method'><h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>bufnum<td class='argumentdesc'>
<p>A reference to the buffer containing the SOM.<tr><td class='argumentname'>inputdata<td class='argumentdesc'>
<p>An Array of the input signals for the net to map.<tr><td class='argumentname'>netsize<td class='argumentdesc'>
<p>The size of the neural net along one dimension. Must match what you trained it with.<tr><td class='argumentname'>numdims<td class='argumentdesc'>
<p>The dimensionality of the neural net. Choose from 1, 2, 3, or 4. Must match what you trained it with.<tr><td class='argumentname'>gate<td class='argumentdesc'>
<p>A simple on-or-off control. When off (gate&lt;=0) the incoming data is ignored (output stays constant).</table></div><h3><a class='anchor' name='Inherited%20class%20methods'>Inherited class methods</a></h3>
<div id='inheritedclassmets'></div><h3><a class='anchor' name='Undocumented%20class%20methods'>Undocumented class methods</a></h3>
<h3 class='method-code'><span class='method-prefix'>SOMRd.</span><a class='method-name' name='*ar' href='./../Overviews/Methods.html#ar'>ar</a>(<span class='argstr'>bufnum</span>, <span class='argstr'>inputdata</span>, <span class='argstr'>netsize: 10</span>, <span class='argstr'>numdims: 2</span>, <span class='argstr'>gate: 1</span>)</h3>
<h3 class='method-code'><span class='method-prefix'>SOMRd.</span><a class='method-name' name='*bufIndexToCoords' href='./../Overviews/Methods.html#bufIndexToCoords'>bufIndexToCoords</a>(<span class='argstr'>bufindex</span>, <span class='argstr'>netsize: 10</span>, <span class='argstr'>numdims: 3</span>)</h3>
<h3 class='method-code'><span class='method-prefix'>SOMRd.</span><a class='method-name' name='*coordsToBufIndex' href='./../Overviews/Methods.html#coordsToBufIndex'>coordsToBufIndex</a>(<span class='argstr'>coords</span>, <span class='argstr'>netsize: 10</span>)</h3>
<h2><a class='anchor' name='instancemethods'>Instance Methods</a></h2>
<h3><a class='anchor' name='Inherited%20instance%20methods'>Inherited instance methods</a></h3>
<div id='inheritedinstmets'></div><h2><a class='anchor' name='examples'>Examples</a></h2>

<p>Here we'll assume you have a SOM trained as in the example from the SOMTrain helpfile, i.e. it's stored in variable ~som, with ~numnodes nodes, and a 1D net trained on 2D input data.<textarea class='editor'>// This simple example takes mouse X and Y coords onscreen and prints the co-ordinate of the nearest node.
// Try drawing a big sinewave across the screen, like the one plotted in the SOMTrain helpfile.
(
x = {
var coords;
coords = SOMRd.kr(~som, [MouseX.kr(0, 2), MouseY.kr(1, -1)], ~numnodes, 1);
coords.poll(4);
}.play
)

// This is the same as above but then retrieves the "template vector" from the SOM and uses it for pitch/cutoff of a tone.
// Top of screen = hi cutoff, bottom of screen = lo cutoff. Left = lo pitch, right = hi pitch.
// Notice how the SOM mapping constrains what is possible, and you get the best resolution by following the sine curve.
(
x = {
var coords, index, vec;
coords = SOMRd.kr(~som, [MouseX.kr(0, 2), MouseY.kr(1, -1)], ~numnodes, 1);
coords.poll(4);
index = SOMRd.coordsToBufIndex(coords, ~numnodes);
vec = BufRd.kr(2, ~som, index); // "vec" is of range [0 to 2, -1 to 1]
MoogFF.ar(Saw.ar(vec[0].linexp(0, 2, 80, 400)), vec[1].linexp(-1, 1, 300, 15000), mul: 0.1).dup;
}.play
)

// Audio-rate example, a slightly weird one.
// Essentially this takes a "query" wave and looks it up in the map, therefore coercing it to a strange sort-of-sine-like shape.
// Try this on the internal server and scope the results.
(
x = {
var freq, query, coords, index, vec;
freq = MouseX.kr(100, 400, 1);
query = LFTri.ar(freq).range(1, -1);
coords = SOMRd.ar(~som, [Saw.ar(freq).range(0, 2), query], ~numnodes, 1);
index = SOMRd.coordsToBufIndex(coords, ~numnodes);
vec = BufRd.ar(2, ~som, index);
[query, vec[1]] * 0.1; // Output the vertical position from the map
}.play
)</textarea>
<div class='doclink'>helpfile source: <a href='file:///usr/share/SuperCollider/Extensions/SC3plugins/MCLDUGens/HelpSource/Classes/SOMRd.schelp'>/usr/share/SuperCollider/Extensions/SC3plugins/MCLDUGens/HelpSource/Classes/SOMRd.schelp</a><br>link::Classes/SOMRd::<br></div></div><script src='./../editor.js' type='text/javascript'></script>
</body></html>
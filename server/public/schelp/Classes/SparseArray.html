<html><head><title>SparseArray</title>
<link rel='stylesheet' href='./../scdoc.css' type='text/css' />
<link rel='stylesheet' href='./../frontend.css' type='text/css' />
<link rel='stylesheet' href='./../custom.css' type='text/css' />
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<script src='./../scdoc.js' type='text/javascript'></script>
<script src='./../docmap.js' type='text/javascript'></script>
<script src='./../prettify.js' type='text/javascript'></script>
<script src='./../lang-sc.js' type='text/javascript'></script>
<script type='text/javascript'>var helpRoot='./..';</script>
</head>
<ul id='menubar'></ul>
<body onload='fixTOC();prettyPrint()'>
<div class='contents'>
<div class='header'>
<div id='label'>SuperCollider CLASSES</div>
<div id='categories'><a href='./../Browse.html#Collections>Ordered'>Collections>Ordered</a></div>
<h1>SparseArray</h1>
<div id='summary'>Array that stores duplicated values more efficiently</div>
</div>
<div class='subheader'>
<div id='filename'>Source: /usr/local/share/SuperCollider/SCClassLibrary/Common/Collections/<a href='file:///usr/local/share/SuperCollider/SCClassLibrary/Common/Collections/SparseArray.sc'>SparseArray.sc</a></div><div id='superclasses'>Inherits from: <a href="../Classes/Order.html">Order</a> : <a href="../Classes/SequenceableCollection.html">SequenceableCollection</a> : <a href="../Classes/Collection.html">Collection</a> : <a href="../Classes/Object.html">Object</a></div>
</div>
<div id='toc'>
<ul class='toc'><li class='toc1'><a href='#description'>Description</a></li>
<ul class='toc'></ul><li class='toc1'><a href='#classmethods'>Class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*newClear'>newClear</a> </li>
<li class='toc3'><a href='#*reduceArray'>reduceArray</a> </li>
<li class='toc2'><a href='#Inherited class methods'>Inherited class methods</a></li>
</ul><li class='toc1'><a href='#instancemethods'>Instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-put'>put</a> </li>
<li class='toc3'><a href='#-at'>at</a> </li>
<li class='toc3'><a href='#-asArray'>asArray</a> </li>
<li class='toc2'><a href='#Inherited instance methods'>Inherited instance methods</a></li>
<li class='toc2'><a href='#Undocumented instance methods'>Undocumented instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-++'>++</a> </li>
<li class='toc3'><a href='#-atSeries'>atSeries</a> </li>
<li class='toc3'><a href='#-clear'>clear</a> </li>
<li class='toc3'><a href='#-collect'>collect</a> </li>
<li class='toc3'><a href='#-compress'>compress</a> </li>
<li class='toc3'><a href='#-copy'>copy</a> </li>
<li class='toc3'><a href='#-default'>default</a> </li>
<li class='toc3'><a href='#-defaultSize'>defaultSize</a> </li>
<li class='toc3'><a href='#-do'>do</a> </li>
<li class='toc3'><a href='#-firstGap'>firstGap</a> </li>
<li class='toc3'><a href='#-indexOf'>indexOf</a> </li>
<li class='toc3'><a href='#-lastIndex'>lastIndex</a> </li>
<li class='toc3'><a href='#-maxItem'>maxItem</a> </li>
<li class='toc3'><a href='#-minItem'>minItem</a> </li>
<li class='toc3'><a href='#-pop'>pop</a> </li>
<li class='toc3'><a href='#-pos'>pos</a> </li>
<li class='toc3'><a href='#-putIfNotDefault'>putIfNotDefault</a> </li>
<li class='toc3'><a href='#-putSeries'>putSeries</a> </li>
<li class='toc3'><a href='#-reject'>reject</a> </li>
<li class='toc3'><a href='#-removeAt'>removeAt</a> </li>
<li class='toc3'><a href='#-select'>select</a> </li>
<li class='toc3'><a href='#-size'>size</a> </li>
<li class='toc3'><a href='#-sparseAddAll'>sparseAddAll</a> </li>
<li class='toc3'><a href='#-sparseCollect'>sparseCollect</a> </li>
<li class='toc3'><a href='#-sparseReject'>sparseReject</a> </li>
<li class='toc3'><a href='#-sparseRemove'>sparseRemove</a> </li>
<li class='toc3'><a href='#-sparseRemoveAt'>sparseRemoveAt</a> </li>
<li class='toc3'><a href='#-sparseSelect'>sparseSelect</a> </li>
<li class='toc3'><a href='#-sparseSum'>sparseSum</a> </li>
<li class='toc3'><a href='#-sum'>sum</a> </li>
</ul></ul><li class='toc1'><a href='#examples'>Examples</a></li>
<ul class='toc'></ul></ul></div><h2><a class='anchor' name='description'>Description</a></h2>

<p>A sparse array is a data structure that acts in exactly the same manner as an Array. However, data is represented differently in memory, in a way that makes it much more efficient to store very large arrays in which many values are the same.
<p>Take for example an array consisting of a million zeroes, with a 1 appended to the end; SparseArray would compress this array by storing zero as a default value, and only explicitly storing the single value that differs, therefore offering a much more economical use of memory.
<p>The benefits of using SparseArray typically arise when creating collections containing many millions of slots.<h2><a class='anchor' name='classmethods'>Class Methods</a></h2>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*newClear' href='./../Overviews/Methods.html#newClear'>newClear</a> (<span class='argstr'>size</span>, <span class='argstr'>default</span>)</h3>
<div class='method'>
<p>Create a new SparseArray of the specified <strong>size</strong>, with each slot's value being <strong>default</strong>.<pre class='code prettyprint lang-sc'>g = SparseArray.newClear(20, 3);
g.postcs;</pre>

<p><h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>size<td class='argumentdesc'>
<p>Number of slots in the desired array. Note that slots are not explicitly created, so the speed of creation is not related to the array size.<tr><td class='argumentname'>default<td class='argumentdesc'>
<p>The default value, i.e. the value that all slots should take at first.</table></div><h3 class='cmethodname'><span class='methprefix'>*</span><a name='*reduceArray' href='./../Overviews/Methods.html#reduceArray'>reduceArray</a> (<span class='argstr'>array</span>, <span class='argstr'>default</span>)</h3>
<div class='method'>
<p>Create a new SparseArray holding the same data as <strong>array</strong>.<pre class='code prettyprint lang-sc'>a = [4, 7, 4, 4, 4, 4, 4, 4, 9, 9, 8];
g = SparseArray.reduceArray(a, 4);
g.postcs;</pre>

<p><h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>array<td class='argumentdesc'>
<p>Any <a href="./../Classes/ArrayedCollection.html">ArrayedCollection</a>.<tr><td class='argumentname'>default<td class='argumentdesc'>
<p>The default value, i.e. the value that all slots should take at first. For best memory efficiency, you should supply the most common value found in the collection.</table></div><h3><a class='anchor' name='Inherited class methods'>Inherited class methods</a></h3>
<div id='inheritedclassmets'></div><h2><a class='anchor' name='instancemethods'>Instance Methods</a></h2>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-put' href='./../Overviews/Methods.html#put'>put</a> (<span class='argstr'>index</span>, <span class='argstr'>obj</span>)</h3>
<div class='supmethod'>From superclass: <a href='./../Classes/Order.html'>Order</a></div>
<div class='method'>
<p>Put a value at the desired index. This works just like all ArrayedCollection types. Behind the scenes the class will ensure the compact representation (deciding whether to store the value explicitly or implicitly).<pre class='code prettyprint lang-sc'>g = SparseArray.newClear(10, 3);
g.put(4, \horse);
g.put(6, [4,5,6]);
g[1] = \hello; // Common compact notation</pre>
</div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-at' href='./../Overviews/Methods.html#at'>at</a> (<span class='argstr'>index</span>)</h3>
<div class='method'>
<p>Retrieve the value at index.<pre class='code prettyprint lang-sc'>g = SparseArray.newClear(20, 3);
g.put(4, \horse);
g.at(4);
g[4];</pre>
</div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-asArray' href='./../Overviews/Methods.html#asArray'>asArray</a> </h3>
<div class='method'>
<p>Convert to an ordinary <a href="./../Classes/Array.html">Array</a>.<pre class='code prettyprint lang-sc'>g = SparseArray.newClear(20, 3);
g.postcs;
g.asArray;</pre>
</div><h3><a class='anchor' name='Inherited instance methods'>Inherited instance methods</a></h3>
<div id='inheritedinstmets'></div><h3><a class='anchor' name='Undocumented instance methods'>Undocumented instance methods</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-++' href='./../Overviews/Methods.html#++'>++</a> (<span class='argstr'>coll</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-atSeries' href='./../Overviews/Methods.html#atSeries'>atSeries</a> (<span class='argstr'>first</span>, <span class='argstr'>second</span>, <span class='argstr'>last</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-clear' href='./../Overviews/Methods.html#clear'>clear</a> (<span class='argstr'>size</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-collect' href='./../Overviews/Methods.html#collect'>collect</a> (<span class='argstr'>function</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-compress' href='./../Overviews/Methods.html#compress'>compress</a> </h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-copy' href='./../Overviews/Methods.html#copy'>copy</a> </h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-default' href='./../Overviews/Methods.html#default'>default</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-default' href='./../Overviews/Methods.html#default'>default</a> = value</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-defaultSize' href='./../Overviews/Methods.html#defaultSize'>defaultSize</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-defaultSize' href='./../Overviews/Methods.html#defaultSize'>defaultSize</a> = value</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-do' href='./../Overviews/Methods.html#do'>do</a> (<span class='argstr'>function</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-firstGap' href='./../Overviews/Methods.html#firstGap'>firstGap</a> (<span class='argstr'>from: 0</span>, <span class='argstr'>to</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-indexOf' href='./../Overviews/Methods.html#indexOf'>indexOf</a> (<span class='argstr'>item</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-lastIndex' href='./../Overviews/Methods.html#lastIndex'>lastIndex</a> </h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-maxItem' href='./../Overviews/Methods.html#maxItem'>maxItem</a> (<span class='argstr'>function</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-minItem' href='./../Overviews/Methods.html#minItem'>minItem</a> (<span class='argstr'>function</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-pop' href='./../Overviews/Methods.html#pop'>pop</a> </h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-pos' href='./../Overviews/Methods.html#pos'>pos</a> </h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-putIfNotDefault' href='./../Overviews/Methods.html#putIfNotDefault'>putIfNotDefault</a> (<span class='argstr'>i</span>, <span class='argstr'>item</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-putSeries' href='./../Overviews/Methods.html#putSeries'>putSeries</a> (<span class='argstr'>first</span>, <span class='argstr'>second</span>, <span class='argstr'>last</span>, <span class='argstr'>value</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-reject' href='./../Overviews/Methods.html#reject'>reject</a> (<span class='argstr'>function</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-removeAt' href='./../Overviews/Methods.html#removeAt'>removeAt</a> (<span class='argstr'>index</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-select' href='./../Overviews/Methods.html#select'>select</a> (<span class='argstr'>function</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-size' href='./../Overviews/Methods.html#size'>size</a> </h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-sparseAddAll' href='./../Overviews/Methods.html#sparseAddAll'>sparseAddAll</a> (<span class='argstr'>coll</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-sparseCollect' href='./../Overviews/Methods.html#sparseCollect'>sparseCollect</a> (<span class='argstr'>function</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-sparseReject' href='./../Overviews/Methods.html#sparseReject'>sparseReject</a> (<span class='argstr'>function</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-sparseRemove' href='./../Overviews/Methods.html#sparseRemove'>sparseRemove</a> (<span class='argstr'>item</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-sparseRemoveAt' href='./../Overviews/Methods.html#sparseRemoveAt'>sparseRemoveAt</a> (<span class='argstr'>index</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-sparseSelect' href='./../Overviews/Methods.html#sparseSelect'>sparseSelect</a> (<span class='argstr'>function</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-sparseSum' href='./../Overviews/Methods.html#sparseSum'>sparseSum</a> (<span class='argstr'>function</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-sum' href='./../Overviews/Methods.html#sum'>sum</a> (<span class='argstr'>function</span>)</h3>
<h2><a class='anchor' name='examples'>Examples</a></h2>

<p>Here we compare speed of Array vs SparseArray.<pre class='code prettyprint lang-sc'>// Let's create a standard array, big but with only a couple of unusual values hidden in there
(
{
    a = {10}.dup(1000000);
    a[551] = 77;
    a[8722] = \foo;
}.bench
)
// Now a SparseArray made out of exactly the same data
(
{
    b = SparseArray.newClear(a.size, 10);
    b[551] = 77;
    b[8722] = \foo;
}.bench
)

// Alternatively you could make the SparseArray out of the existing array,
// although this is typically not as efficient as starting from scratch
// since the Array needs to be scanned directly.
(
{
    b = SparseArray.reduceArray(a, 10);
}.bench
)

// accessing:
{1000.do{ a[a.size.rand] == 60.rand }}.bench
{1000.do{ b[b.size.rand] == 60.rand }}.bench
// setting:
{1000.do{ a[a.size.rand] = 60.rand }}.bench
{1000.do{ b[b.size.rand] = 60.rand }}.bench</pre>

<p><div class='doclink'>source: <a href='file:///usr/local/share/SuperCollider/HelpSource/Classes/SparseArray.schelp'>/usr/local/share/SuperCollider/HelpSource/Classes/SparseArray.schelp</a><br>link::Classes/SparseArray::<br>sc version: 3.8dev</div></div></body></html>
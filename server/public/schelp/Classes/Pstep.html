<html><head><title>Pstep</title>
<link rel='stylesheet' href='./../scdoc.css' type='text/css' />
<link rel='stylesheet' href='./../frontend.css' type='text/css' />
<link rel='stylesheet' href='./../custom.css' type='text/css' />
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<script src='./../scdoc.js' type='text/javascript'></script>
<script src='./../docmap.js' type='text/javascript'></script>
<script src='./../prettify.js' type='text/javascript'></script>
<script src='./../lang-sc.js' type='text/javascript'></script>
<script type='text/javascript'>var helpRoot='./..';</script>
</head>
<ul id='menubar'></ul>
<body onload='fixTOC();prettyPrint()'>
<div class='contents'>
<div class='header'>
<div id='label'>SuperCollider CLASSES</div>
<div id='categories'><a href='./../Browse.html#Streams-Patterns-Events>Patterns>Time'>Streams-Patterns-Events>Patterns>Time</a></div>
<h1>Pstep</h1>
<div id='summary'>timed embedding of values</div>
</div>
<div class='subheader'>
<div id='filename'>Source: /usr/local/share/SuperCollider/SCClassLibrary/Common/Streams/<a href='file:///usr/local/share/SuperCollider/SCClassLibrary/Common/Streams/TimePatterns.sc'>TimePatterns.sc</a></div><div id='superclasses'>Inherits from: <a href="../Classes/Pattern.html">Pattern</a> : <a href="../Classes/AbstractFunction.html">AbstractFunction</a> : <a href="../Classes/Object.html">Object</a></div>
<div id='subclasses'>Subclasses: <a href="../Classes/Pseg.html">Pseg</a></div>
<div id='related'>See also: <a href="./../Classes/Pseg.html">Pseg</a></div>
</div>
<div id='toc'>
<ul class='toc'><li class='toc1'><a href='#description'>Description</a></li>
<ul class='toc'></ul><li class='toc1'><a href='#classmethods'>Class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*new'>new</a> </li>
<li class='toc2'><a href='#Inherited class methods'>Inherited class methods</a></li>
</ul><li class='toc1'><a href='#instancemethods'>Instance methods</a></li>
<ul class='toc'><li class='toc2'><a href='#Inherited instance methods'>Inherited instance methods</a></li>
<li class='toc2'><a href='#Undocumented instance methods'>Undocumented instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-durs'>durs</a> </li>
<li class='toc3'><a href='#-embedInStream'>embedInStream</a> </li>
<li class='toc3'><a href='#-list'>list</a> </li>
<li class='toc3'><a href='#-repeats'>repeats</a> </li>
</ul></ul><li class='toc1'><a href='#examples'>Examples</a></li>
<ul class='toc'></ul></ul></div><h2><a class='anchor' name='description'>Description</a></h2>

<p>Pstep is good for representing chord progressions, scale progressions, accent patterns, etc.<h2><a class='anchor' name='classmethods'>Class Methods</a></h2>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*new' href='./../Overviews/Methods.html#new'>new</a> (<span class='argstr'>levels</span>, <span class='argstr'>durs: 1</span>, <span class='argstr'>repeats: 1</span>)</h3>
<div class='method'>
<p>Levelpattern can return individual values, arrays, or events. The value returned by levelpattern is returned for the duration returned by durpattern.</div><h3><a class='anchor' name='Inherited class methods'>Inherited class methods</a></h3>
<div id='inheritedclassmets'></div><h2><a class='anchor' name='instancemethods'>Instance Methods</a></h2>
<h3><a class='anchor' name='Inherited instance methods'>Inherited instance methods</a></h3>
<div id='inheritedinstmets'></div><h3><a class='anchor' name='Undocumented instance methods'>Undocumented instance methods</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-durs' href='./../Overviews/Methods.html#durs'>durs</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-durs' href='./../Overviews/Methods.html#durs'>durs</a> = value</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-embedInStream' href='./../Overviews/Methods.html#embedInStream'>embedInStream</a> (<span class='argstr'>inval</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-list' href='./../Overviews/Methods.html#list'>list</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-list' href='./../Overviews/Methods.html#list'>list</a> = value</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-repeats' href='./../Overviews/Methods.html#repeats'>repeats</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-repeats' href='./../Overviews/Methods.html#repeats'>repeats</a> = value</h3>
<h2><a class='anchor' name='examples'>Examples</a></h2>
<pre class='code prettyprint lang-sc'>(
// select a chord and duration and repeat it for a random time interval
p = Pstep(
    Pbind(
        \ctranspose, [0, 4, 7],
        \note,    Pwhite(0, 12),
        \dur,    Prand([0.2, 0.4, 0.8], inf)
    ),
    Prand([1, 2, 4], inf)/4
);
Ppar([p, p]).play;
)
// change degree independant of number of events that have been playing

(
Pchain(
    Ppar([
        Pbind(
            \degree, Pbrown(0, 12, 1),
            \dur, Pstep( Pseq([0.1, 0.2, 0.4, 0.8, 1.6], inf), 3.2)
        ),
        Pbind(
            \degree, Pbrown(0, 20, 1),
            \dur, Pstep( Pseq([0.1, 0.2, 0.4, 0.8, 1.6], inf), 4.5)
        )
    ]),
    Pbind(
        \scale, Pstep(Pseq([ [0, 2, 4, 5, 7, 9, 11], [0, 1, 2, 3, 4, 5, 6]], inf), 5),
        \db, Pstep(Pseq([2, -2, 0, -2], inf), 0.25) - 10
    )
).play;
)

// use a simple pattern
(
Pchain(
    Ppar([
        Pbind(
            \octave, [5, 6] + Prand([0, 0, \r], inf),
            \degree, Prout({ | ev | loop { ev = Pseq(ev[\degree]).embedInStream } }),
            \dur,    Prout({ loop { Pseq([0.2, 0.2, 0.2, 0.2, 0.3].scramble).embedInStream } })
        ),
        Pbind(
            \octave, 4,
            \legato, 1.2,
            \dur, Prout({ loop { Pseq([0.2, 0.2, 0.2, 0.2, 0.3].scramble * 5).embedInStream }})
        ),
    ]),
    Pstep(Pbind(
        \db, Pseq([0, -4, -2, -4, -3, -4, -3, -4], inf) - 20
    ), 0.2),
    Pstep(
        Pbind(
            \degree,     Pfunc({ {10.rand}.dup(10) }),
            \scale,    Pfunc({ {rrand(1, 2)}.dup(7).integrate })
        ),
        5
    )
).play
)



// change one parameter
(
Pbind(
    \degree, Pstep(Pseq([1, 2, 3, 4, 5]), 1.0).trace,
    \dur, Pseries(0.1, 0.1, 15)
).play;
)


// change degree independant of number of events that have been playing

(
var a, b;
a = Pbind(
    \degree, Pstep(Pseq([0, 2b, 3], 1), 1.0),
    \dur, Prand([0.2, 0.5, 1.1, 0.25, 0.15], inf)
);
b = Pbind(
    \degree, Pseq([0, 2b, 3], 1),
    \dur, 2,
    \ctranspose, -7
);
Pseq([Event.silent(1.25), Ppar([a, b])], inf).play;
)



// test tempo changes

(
var a, b;
a = Pbind(
    \degree, Pstep(Pseq([0, 2b, 3], 1), 1.0),
    \dur, Prand([0.2, 0.5, 1.1, 0.25, 0.15], 9)
);
b = Pbind(
    \degree, Pseq([0, 2b, 3], 1),
    \dur, 2,
    \ctranspose, -7
);

Ppar([a, b], inf).play;
)


SystemClock.sched(0, { TempoClock.default.tempo = [1, 2, 3, 5].choose.postln; 2 });

TempoClock.default.tempo = 1.0;



// timing test:
// parallel streams


(
var a, b, x;
var times, levels;

SynthDef(\pgrain,
    { arg out = 0, freq=800, sustain=0.001, amp=0.5, pan = 0;
        var window;
        window = Env.sine(sustain, amp);
        Out.ar(out,
            Pan2.ar(
                SinOsc.ar(freq) * EnvGen.ar(window, doneAction:2),
                pan
            )
        )
    }
).add;

times = Pseq([3.4, 1, 0.2, 0.2, 0.2], inf);
levels = Pseq([0, 1, 2, 3, 4], inf);

a = Pstep(levels, times);
b = Pbind(\instrument, \pgrain, \octave, 7, \dur, 0.12, \degree, a);
x = times;

Ppar([b, Pset(\mtranspose, 2, b) ]).play;

b.play;
r {
    var z = x.asStream; // direct times
    0.5.wait;
    loop {
        z.next.wait;
        s.makeBundle(0.2, {
            Synth(\pgrain, [\freq, 3000, \sustain, 0.01]); // signal tone
        })
    }
}.play(quant:1)
)</pre>

<p><div class='doclink'>source: <a href='file:///usr/local/share/SuperCollider/HelpSource/Classes/Pstep.schelp'>/usr/local/share/SuperCollider/HelpSource/Classes/Pstep.schelp</a><br>link::Classes/Pstep::<br>sc version: 3.8dev</div></div></body></html>
<html><head><title>Maybe</title>
<link rel='stylesheet' href='./../scdoc.css' type='text/css' />
<link rel='stylesheet' href='./../frontend.css' type='text/css' />
<link rel='stylesheet' href='./../custom.css' type='text/css' />
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<script src='./../scdoc.js' type='text/javascript'></script>
<script src='./../docmap.js' type='text/javascript'></script>
<script src='./../prettify.js' type='text/javascript'></script>
<script src='./../lang-sc.js' type='text/javascript'></script>
<script type='text/javascript'>var helpRoot='./..';</script>
</head>
<ul id='menubar'></ul>
<body onload='fixTOC();prettyPrint()'>
<div class='contents'>
<div class='header'>
<div id='label'>SuperCollider CLASSES</div>
<div id='categories'><a href='./../Browse.html#Libraries>JITLib>Environments'>Libraries>JITLib>Environments</a>, <a href='./../Browse.html#Live Coding'>Live Coding</a></div>
<h1>Maybe</h1>
<div id='summary'>referentially transparent proxy object</div>
</div>
<div class='subheader'>
<div id='filename'>Source: /usr/local/share/SuperCollider/SCClassLibrary/JITLib/Patterns/<a href='file:///usr/local/share/SuperCollider/SCClassLibrary/JITLib/Patterns/Fdef.sc'>Fdef.sc</a></div><div id='superclasses'>Inherits from: <a href="../Classes/Ref.html">Ref</a> : <a href="../Classes/AbstractFunction.html">AbstractFunction</a> : <a href="../Classes/Object.html">Object</a></div>
<div id='subclasses'>Subclasses: <a href="../Classes/Fdef.html">Fdef</a></div>
<div id='related'>See also: <a href="./../Classes/Fdef.html">Fdef</a>, <a href="./../Overviews/JITLib.html">JITLib</a></div>
</div>
<div id='toc'>
<ul class='toc'><li class='toc1'><a href='#description'>Description</a></li>
<ul class='toc'></ul><li class='toc1'><a href='#classmethods'>Class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*new'>new</a> </li>
<li class='toc2'><a href='#Inherited class methods'>Inherited class methods</a></li>
<li class='toc2'><a href='#Undocumented class methods'>Undocumented class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*callFunc'>callFunc</a> </li>
<li class='toc3'><a href='#*callers'>callers</a> </li>
<li class='toc3'><a href='#*current'>current</a> </li>
<li class='toc3'><a href='#*defaultValue'>defaultValue</a> </li>
<li class='toc3'><a href='#*protected'>protected</a> </li>
<li class='toc3'><a href='#*verbose'>verbose</a> </li>
</ul></ul><li class='toc1'><a href='#instancemethods'>Instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-source'>source</a> </li>
<li class='toc3'><a href='#-value'>value</a> </li>
<li class='toc3'><a href='#-apply'>apply</a> </li>
<li class='toc3'><a href='#-doesNotUnderstand'>doesNotUnderstand</a> </li>
<li class='toc2'><a href='#Inherited instance methods'>Inherited instance methods</a></li>
<li class='toc2'><a href='#Undocumented instance methods'>Undocumented instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-<>'>&lt;&gt;</a> </li>
<li class='toc3'><a href='#-all'>all</a> </li>
<li class='toc3'><a href='#-catchRecursion'>catchRecursion</a> </li>
<li class='toc3'><a href='#-clear'>clear</a> </li>
<li class='toc3'><a href='#-composeBinaryOp'>composeBinaryOp</a> </li>
<li class='toc3'><a href='#-composeNAryOp'>composeNAryOp</a> </li>
<li class='toc3'><a href='#-composeUnaryOp'>composeUnaryOp</a> </li>
<li class='toc3'><a href='#-do'>do</a> </li>
<li class='toc3'><a href='#-embedInStream'>embedInStream</a> </li>
<li class='toc3'><a href='#-findKey'>findKey</a> </li>
<li class='toc3'><a href='#-functionPerformList'>functionPerformList</a> </li>
<li class='toc3'><a href='#-includedInCallers'>includedInCallers</a> </li>
<li class='toc3'><a href='#-infoString'>infoString</a> </li>
<li class='toc3'><a href='#-o'>o</a> </li>
<li class='toc3'><a href='#-postString'>postString</a> </li>
<li class='toc3'><a href='#-reduceFuncProxy'>reduceFuncProxy</a> </li>
<li class='toc3'><a href='#-reverseComposeBinaryOp'>reverseComposeBinaryOp</a> </li>
<li class='toc3'><a href='#-valueArray'>valueArray</a> </li>
<li class='toc3'><a href='#-valueArrayEnvir'>valueArrayEnvir</a> </li>
<li class='toc3'><a href='#-valueEnvir'>valueEnvir</a> </li>
<li class='toc3'><a href='#-valueFuncProxy'>valueFuncProxy</a> </li>
</ul></ul><li class='toc1'><a href='#examples'>Examples</a></li>
<ul class='toc'></ul></ul></div><h2><a class='anchor' name='description'>Description</a></h2>

<p>A Maybe object can contain either nil or some other object, and allows to construct calculations without knowing this other object yet. If the calculation fails, due to a loop or a not yet defined object, Maybe returns nil.
<p>The name <strong>Maybe</strong> stems from the programming language Haskell, where it represents a somewhat similar entity. See also: <a href="./../Classes/Fdef.html">Fdef</a><h2><a class='anchor' name='classmethods'>Class Methods</a></h2>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*new' href='./../Overviews/Methods.html#new'>new</a> (<span class='argstr'>thing</span>)</h3>
<div class='supmethod'>From superclass: <a href='./../Classes/Ref.html'>Ref</a></div>
<div class='method'>
<p>create a new instance<h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>thing<td class='argumentdesc'>
<p>an object or nil.<pre class='code prettyprint lang-sc'>a = Maybe.new;
b = Maybe(a + 6);
b.value; // =&gt; nil
a.value = 1;
b.value; // =&gt; 7</pre>
</table></div><h3><a class='anchor' name='Inherited class methods'>Inherited class methods</a></h3>
<div id='inheritedclassmets'></div><h3><a class='anchor' name='Undocumented class methods'>Undocumented class methods</a></h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*callFunc' href='./../Overviews/Methods.html#callFunc'>callFunc</a></h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*callFunc' href='./../Overviews/Methods.html#callFunc'>callFunc</a> = value</h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*callers' href='./../Overviews/Methods.html#callers'>callers</a> </h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*current' href='./../Overviews/Methods.html#current'>current</a> </h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*defaultValue' href='./../Overviews/Methods.html#defaultValue'>defaultValue</a></h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*defaultValue' href='./../Overviews/Methods.html#defaultValue'>defaultValue</a> = value</h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*protected' href='./../Overviews/Methods.html#protected'>protected</a></h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*protected' href='./../Overviews/Methods.html#protected'>protected</a> = value</h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*verbose' href='./../Overviews/Methods.html#verbose'>verbose</a></h3>
<h3 class='cmethodname'><span class='methprefix'>*</span><a name='*verbose' href='./../Overviews/Methods.html#verbose'>verbose</a> = value</h3>
<h2><a class='anchor' name='instancemethods'>Instance Methods</a></h2>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-source' href='./../Overviews/Methods.html#source'>source</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-source' href='./../Overviews/Methods.html#source'>source</a> = <span class='argstr'>obj</span></h3>
<div class='method'>
<p>return or set the contained object</div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-value' href='./../Overviews/Methods.html#value'>value</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-value' href='./../Overviews/Methods.html#value'>value</a> = value</h3>
<div class='method'>
<p>set the contained object or return the source, or the value of the contained object, if it is a Maybe. If there is a recursion, return nil.</div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-apply' href='./../Overviews/Methods.html#apply'>apply</a> ( <span class='argstr'>... args</span>)</h3>
<div class='method'>
<p>return the value, or the value of the contained object, if it is a Maybe. This method allows recursion, so that recursive calcualtions can be made.</div><h3 class='imethodname'><span class='methprefix'>-</span><a name='-doesNotUnderstand' href='./../Overviews/Methods.html#doesNotUnderstand'>doesNotUnderstand</a> (<span class='argstr'>selector</span> <span class='argstr'>... args</span>)</h3>
<div class='method'>
<p>(called by any message that Maybe doesn't understand.)
<p>returns a composition function that, when evaluated, returns the value.<pre class='code prettyprint lang-sc'>a = Maybe.new;
a.respondsTo(\flop) // false: Maybe constructs a placeholder instead
b = Maybe(a.flop);
b.value; // =&gt; nil
a.value = [1, 2, [2, 3]];
b.value;    // =&gt; [ [ 1, 2, 2 ], [ 1, 2, 3 ] ]</pre>
</div><h3><a class='anchor' name='Inherited instance methods'>Inherited instance methods</a></h3>
<div id='inheritedinstmets'></div><h3><a class='anchor' name='Undocumented instance methods'>Undocumented instance methods</a></h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-<>' href='./../Overviews/Methods.html#&lt;&gt;'>&lt;&gt;</a> (<span class='argstr'>that</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-all' href='./../Overviews/Methods.html#all'>all</a> </h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-catchRecursion' href='./../Overviews/Methods.html#catchRecursion'>catchRecursion</a> (<span class='argstr'>func</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-clear' href='./../Overviews/Methods.html#clear'>clear</a> </h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-composeBinaryOp' href='./../Overviews/Methods.html#composeBinaryOp'>composeBinaryOp</a> (<span class='argstr'>aSelector</span>, <span class='argstr'>something</span>, <span class='argstr'>adverb</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-composeNAryOp' href='./../Overviews/Methods.html#composeNAryOp'>composeNAryOp</a> (<span class='argstr'>aSelector</span>, <span class='argstr'>anArgList</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-composeUnaryOp' href='./../Overviews/Methods.html#composeUnaryOp'>composeUnaryOp</a> (<span class='argstr'>aSelector</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-do' href='./../Overviews/Methods.html#do'>do</a> (<span class='argstr'>function</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-embedInStream' href='./../Overviews/Methods.html#embedInStream'>embedInStream</a> (<span class='argstr'>inval</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-findKey' href='./../Overviews/Methods.html#findKey'>findKey</a> </h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-functionPerformList' href='./../Overviews/Methods.html#functionPerformList'>functionPerformList</a> (<span class='argstr'>selector</span>, <span class='argstr'>arglist</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-includedInCallers' href='./../Overviews/Methods.html#includedInCallers'>includedInCallers</a> </h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-infoString' href='./../Overviews/Methods.html#infoString'>infoString</a> (<span class='argstr'>args</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-o' href='./../Overviews/Methods.html#o'>o</a> ( <span class='argstr'>... args</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-postString' href='./../Overviews/Methods.html#postString'>postString</a> </h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-reduceFuncProxy' href='./../Overviews/Methods.html#reduceFuncProxy'>reduceFuncProxy</a> (<span class='argstr'>args</span>, <span class='argstr'>protect: true</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-reverseComposeBinaryOp' href='./../Overviews/Methods.html#reverseComposeBinaryOp'>reverseComposeBinaryOp</a> (<span class='argstr'>aSelector</span>, <span class='argstr'>something</span>, <span class='argstr'>adverb</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-valueArray' href='./../Overviews/Methods.html#valueArray'>valueArray</a> (<span class='argstr'>args</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-valueArrayEnvir' href='./../Overviews/Methods.html#valueArrayEnvir'>valueArrayEnvir</a> ( <span class='argstr'>... args</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-valueEnvir' href='./../Overviews/Methods.html#valueEnvir'>valueEnvir</a> ( <span class='argstr'>... args</span>)</h3>
<h3 class='imethodname'><span class='methprefix'>-</span><a name='-valueFuncProxy' href='./../Overviews/Methods.html#valueFuncProxy'>valueFuncProxy</a> (<span class='argstr'>args</span>)</h3>
<h2><a class='anchor' name='examples'>Examples</a></h2>
<pre class='code prettyprint lang-sc'>// the following examples use a LazyEnvir with a Maybe as a proxy class.
// instead of writing a = Maybe.new; a.value = something;
// one can simply write ~a = something.
// the Maybe is implictly created for you.

(
    p.pop.clear;
    p = LazyEnvir.new;
    p.proxyClass = Maybe;
    p.linkDoc; // here: connect to current doc only.
);


// sets
~a = Set[0, 4, 5, 7];
~b = Set[4, 5];
~c = ~a union: ~b; // union of the two sets (note that the shortcut | does not work here.).
~d = ~a sect: ~b; // intersection of a and b
~c.postcs;""; // post the whole construction
~d.postcs;"";
~c.value; // Set[ 4, 0, 5, 7 ]
~d.value; // Set[ 4, 5 ]
~b = Set[4, 5, 13, 0];
~c.value;
~d.value; // Set[ 4, 0, 5 ]
~b.source.add(~w); // add another placeholder
~c.value; // it is part of the union.
~d.value; // but not part of the intersection


// envirs
~a = (note: [1, 2]);
~b = (dur: 1);
~c = ~a.putAll(~b) // provisionally put everything into the placholder
~c.value;
~a = (note: [1, 2, 4]);
~c.value;
~d = ~a.at(\note);
~d.value;
~a = (note: [7.5]);
~d.value; // [7.5]

// patterns
~a = Pseq([1, 2, 3]);
~b = Pseq([5, ~a, ~a + 10], inf);
~b.value.asStream.nextN(10);


~a = Prand([100, 200]);
~b.value.asStream.nextN(10);


// to do : flop!

//////////////// deep recursion

// with normal functions:
f = { |x| if(x &lt;= 1) { 1 } { x * f.(x - 1) } };
f.(12)


~faculty = { |x| if(x == 1) { 1 } { x * ~faculty.(x - 1) } };
~faculty.(12) // doesn't work (=&gt; nil). here we _do_ want recursion ...

// for explicit recursion use "apply"
~faculty = { |x| if(x == 1) { 1 } { x * ~faculty.apply(x - 1) } };
~faculty.(12)

/*// safety (not yet implemented)
Maybe.maxDepth = 1e2; // higher depth is risky..
~faculty = { |x| x * ~faculty.apply(x - 1) }; // infinite recursion
~faculty.(12)

Maybe.maxDepth = nil; // unsafe again.*/


//////////////// recursion prevention tests

~b = ~a;
~a = ~b;
~a.value; // =&gt; nil


~a = ~b;
~b = ~c;
~c = ~a;
~a.value; // =&gt; nil

~a = ~b + ~c;
~c = ~a;
~a.value; // =&gt; nil


~a = ~b;
~b = 19;
~a.value; // =&gt; 19
~b.value; // =&gt; 19

// function evaluation and argument passing

~a = { |x| x + 2 };
~a.value; // =&gt; nil

~a.value(~c); // =&gt; nil
~b = 2000;
~a.value(~b); // =&gt; 2002
~x = [600, 1000];

(~a + 1).value(~b); // 2003
(~a + 1).value(~x); // [ 603, 1003 ]
(~a + 1).value({ 8 }); // binary op func.
(~a + 1).value({ 5 + 3 }).value // 11

~a = { |x| x + 2 + ~b };
~a.value(8); // 2010

~c = nil;
~a = { |x| x + 2 + ~c }; // ~c is undefined.
~a.value(8); // =&gt; nil

~c = 100; // define ~c

~a.value(8); // now returns a value.

~c = ~b; // now recursion?
~b = ~a;
~a.value(8); // caught recursion =&gt; nil

~c = { 100.rand }; // ~c is a function

~a.value(8);
~a.value(8);

~c = { ~a + ~b };
~a.value(8);    // ~c is a recursion with ~a =&gt; nil


// function composition
~a = {|x| x + 1 };
~v = ~a &lt;&gt; ~a &lt;&gt; ~a; // same as: { ~a.(~a.(~a)) }
~v.value(0); // =&gt; 3

~a = {|x| x + 2 };
~v.value(0); // transparent. =&gt; 6

// {|x| x }.valueEnvir // doesn't work with current implementation of Function:valueEnvir


// calculations with functions:
~c = 0;
~a = { |ff| { ff = ff + 1; ~c + ff + 2 + ~c } };
~x = ~a.value(8);
~x.value; // return 11, 12, 13...
~x.value;
~x.value;
~c = 100;
~x.value; // return 214, 215 ...
~x.value;

// binary op functions:
~c = 0;
~a = { |ff| { [600, 800] } + { ff + 2 + ~c } };

~x = ~a.value(8);
~x.value; // return [ 610, 810 ]

~c = { [10, -10].rand };
~x.value; // return random between [ 610..620, 800..810 ]</pre>

<p><div class='doclink'>source: <a href='file:///usr/local/share/SuperCollider/HelpSource/Classes/Maybe.schelp'>/usr/local/share/SuperCollider/HelpSource/Classes/Maybe.schelp</a><br>link::Classes/Maybe::<br>sc version: 3.8dev</div></div></body></html>